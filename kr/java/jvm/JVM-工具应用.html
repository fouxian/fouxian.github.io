<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JVM 工具应用 | Keep Running</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.png">
    <script charset="utf-8" async="async" src="/js/jquery.min.js"></script>
    <script charset="utf-8" async="async" src="/js/global.js"></script>
    <script charset="utf-8" async="async" src="/js/fingerprint2.min.js"></script>
    <meta name="description" content="">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link rel="preload" href="/assets/css/0.styles.42b858ce.css" as="style"><link rel="preload" href="/assets/js/app.cfd60917.js" as="script"><link rel="preload" href="/assets/js/4.8234885e.js" as="script"><link rel="preload" href="/assets/js/3.1429892b.js" as="script"><link rel="preload" href="/assets/js/45.c31e6474.js" as="script"><link rel="prefetch" href="/assets/js/10.0f0de338.js"><link rel="prefetch" href="/assets/js/11.0c47d372.js"><link rel="prefetch" href="/assets/js/12.b45ce082.js"><link rel="prefetch" href="/assets/js/13.f2032214.js"><link rel="prefetch" href="/assets/js/14.0a8927b2.js"><link rel="prefetch" href="/assets/js/15.9ab1d206.js"><link rel="prefetch" href="/assets/js/16.f03f2e40.js"><link rel="prefetch" href="/assets/js/17.c6bbe2be.js"><link rel="prefetch" href="/assets/js/18.e08bb862.js"><link rel="prefetch" href="/assets/js/19.c00af7cb.js"><link rel="prefetch" href="/assets/js/20.35396483.js"><link rel="prefetch" href="/assets/js/21.fe05d239.js"><link rel="prefetch" href="/assets/js/22.80eaa289.js"><link rel="prefetch" href="/assets/js/23.bce5e854.js"><link rel="prefetch" href="/assets/js/24.fa104861.js"><link rel="prefetch" href="/assets/js/25.2c725be9.js"><link rel="prefetch" href="/assets/js/26.fc7addb7.js"><link rel="prefetch" href="/assets/js/27.fc831a66.js"><link rel="prefetch" href="/assets/js/28.3784f580.js"><link rel="prefetch" href="/assets/js/29.7e78aa5c.js"><link rel="prefetch" href="/assets/js/30.b074fddd.js"><link rel="prefetch" href="/assets/js/31.059ebf27.js"><link rel="prefetch" href="/assets/js/32.12570018.js"><link rel="prefetch" href="/assets/js/33.d0dc971f.js"><link rel="prefetch" href="/assets/js/34.c9b46696.js"><link rel="prefetch" href="/assets/js/35.77a81c6a.js"><link rel="prefetch" href="/assets/js/36.6048e328.js"><link rel="prefetch" href="/assets/js/37.b9f285de.js"><link rel="prefetch" href="/assets/js/38.ac5a2abf.js"><link rel="prefetch" href="/assets/js/39.97ca52cb.js"><link rel="prefetch" href="/assets/js/40.1689d33f.js"><link rel="prefetch" href="/assets/js/41.4d2d8182.js"><link rel="prefetch" href="/assets/js/42.8647a8ff.js"><link rel="prefetch" href="/assets/js/43.f867a280.js"><link rel="prefetch" href="/assets/js/44.a51272ee.js"><link rel="prefetch" href="/assets/js/46.fe85ae54.js"><link rel="prefetch" href="/assets/js/47.dc8a97d4.js"><link rel="prefetch" href="/assets/js/48.c97f7726.js"><link rel="prefetch" href="/assets/js/49.ac219d14.js"><link rel="prefetch" href="/assets/js/5.963fada3.js"><link rel="prefetch" href="/assets/js/50.926ecfa5.js"><link rel="prefetch" href="/assets/js/51.e776b5b1.js"><link rel="prefetch" href="/assets/js/52.4938314c.js"><link rel="prefetch" href="/assets/js/53.6b4d7266.js"><link rel="prefetch" href="/assets/js/54.bfaf622b.js"><link rel="prefetch" href="/assets/js/55.c6d160b9.js"><link rel="prefetch" href="/assets/js/56.31f6843c.js"><link rel="prefetch" href="/assets/js/57.55cbf7b8.js"><link rel="prefetch" href="/assets/js/58.8174871d.js"><link rel="prefetch" href="/assets/js/59.3eee2bde.js"><link rel="prefetch" href="/assets/js/6.b2e36a75.js"><link rel="prefetch" href="/assets/js/60.233a32ed.js"><link rel="prefetch" href="/assets/js/61.defb83ac.js"><link rel="prefetch" href="/assets/js/62.442070cd.js"><link rel="prefetch" href="/assets/js/63.cc121456.js"><link rel="prefetch" href="/assets/js/64.c8f83f5d.js"><link rel="prefetch" href="/assets/js/65.b9bc8c1c.js"><link rel="prefetch" href="/assets/js/7.fb6689bf.js"><link rel="prefetch" href="/assets/js/8.e390cc6b.js"><link rel="prefetch" href="/assets/js/9.c03c9dfe.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.db8a86c9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.42b858ce.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Keep Running</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/kr/java/jvm/自动内存管理.html" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/kr/database/database.html" class="nav-link">
  数据库
</a></div><div class="nav-item"><a href="/kr/spring/MVC-IOC-AOP.html" class="nav-link">
  Spring
</a></div><div class="nav-item"><a href="/kr/middleware/redis/redis-base.html" class="nav-link">
  Redis/Zookeeper/Kafka
</a></div><div class="nav-item"><a href="/kr/bigdata/hadoop/Hadoop-分布式集群容器部署.html" class="nav-link">
  大数据
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/kr/java/jvm/自动内存管理.html" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/kr/database/database.html" class="nav-link">
  数据库
</a></div><div class="nav-item"><a href="/kr/spring/MVC-IOC-AOP.html" class="nav-link">
  Spring
</a></div><div class="nav-item"><a href="/kr/middleware/redis/redis-base.html" class="nav-link">
  Redis/Zookeeper/Kafka
</a></div><div class="nav-item"><a href="/kr/bigdata/hadoop/Hadoop-分布式集群容器部署.html" class="nav-link">
  大数据
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>JVM</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/kr/java/jvm/自动内存管理.html" class="sidebar-link">自动内存管理</a></li><li><a href="/kr/java/jvm/类加载机制.html" class="sidebar-link">类加载机制</a></li><li><a href="/kr/java/jvm/JVM-工具应用.html" class="active sidebar-link">JVM 工具应用</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>JUC</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/kr/java/juc/juc.html" class="sidebar-link">JUC</a></li><li><a href="/kr/java/juc/互斥同步-解决方案.html" class="sidebar-link">互斥同步-解决方案</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>集合</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/kr/java/collection/Java-集合.html" class="sidebar-link">Java 集合</a></li><li><a href="/kr/java/collection/常见容错机制.html" class="sidebar-link">常见容错机制</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Other</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/kr/java/other/docker-use.html" class="sidebar-link">Docker 使用问题记录</a></li><li><a href="/kr/java/other/Pro-Git-学习总结.html" class="sidebar-link">分布式版本控制系统 Git 学习总结</a></li><li><a href="/kr/java/other/Linux.html" class="sidebar-link">Linux</a></li></ul></section></li></ul> </aside> <div><main class="page"> <div class="theme-default-content content__default"><h1 id="jvm-工具应用"><a href="#jvm-工具应用" class="header-anchor">#</a> JVM 工具应用</h1> <h2 id="jdk-故障处理工具"><a href="#jdk-故障处理工具" class="header-anchor">#</a> JDK 故障处理工具</h2> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># JDK/bin</span>
$ <span class="token function">ls</span>
appletviewer.exe*  javafxpackager.exe*  jdb.exe*         jsadebugd.exe*  native2ascii.exe*  servertool.exe*
extcheck.exe*      javah.exe*           jdeps.exe*       jstack.exe*     orbd.exe*          tnameserv.exe*
idlj.exe*          javap.exe*           jhat.exe*        jstat.exe*      pack200.exe*       unpack200.exe*
jabswitch.exe*     javapackager.exe*    jinfo.exe*       jstatd.exe*     policytool.exe*    vcruntime140.dll*
jar.exe*           java-rmi.exe*        jjs.exe*         jvisualvm.exe*  rmic.exe*          wsgen.exe*
jarsigner.exe*     javaw.exe*           jli.dll*         keytool.exe*    rmid.exe*          wsimport.exe*
java.exe*          javaws.exe*          jmap.exe*        kinit.exe*      rmiregistry.exe*   xjc.exe*
javac.exe*         jcmd.exe*            jps.exe*         klist.exe*      schemagen.exe*
javadoc.exe*       jconsole.exe*        jrunscript.exe*  ktab.exe*       serialver.exe*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="jps-进程监控"><a href="#jps-进程监控" class="header-anchor">#</a> JPS 进程监控</h3> <p>类似于 Linux <code>PS</code> 命令（显示当前系统所有进程），<code>JPS</code> 显示当前用户具有访问权限的所有 JVM 进程，可以简单理解为 PS 的子集</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ jps -help
usage: jps <span class="token punctuation">[</span>-help<span class="token punctuation">]</span>
       jps <span class="token punctuation">[</span>-q<span class="token punctuation">]</span> <span class="token punctuation">[</span>-mlvV<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>hostid<span class="token operator">&gt;</span><span class="token punctuation">]</span>

Definitions:
    <span class="token operator">&lt;</span>hostid<span class="token operator">&gt;</span>:      <span class="token operator">&lt;</span>hostname<span class="token operator">&gt;</span><span class="token punctuation">[</span>:<span class="token operator">&lt;</span>port<span class="token operator">&gt;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>-q：只输出进程的本地虚拟机唯一 ID（LVMID，Local Virtual Machine Identifier）</li> <li>-l：输出 main 类或 Jar 的 全限定名</li> <li>-m：输出传入 main 方法的参数</li> <li>-v：输出虚拟机进程启动时显示指定的 JVM 参数</li></ul> <h3 id="jstat-统计信息"><a href="#jstat-统计信息" class="header-anchor">#</a> JSTAT 统计信息</h3> <p>JSTAT：用于识别虚拟机各种运行状态信息，可以显示本地或远程虚拟机进程中的类装载、内存、垃圾收集、JIT 编译等运行时数据</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ jstat -help
Usage: jstat -help<span class="token operator">|</span>-options
       jstat -<span class="token operator">&lt;</span>option<span class="token operator">&gt;</span> <span class="token punctuation">[</span>-t<span class="token punctuation">]</span> <span class="token punctuation">[</span>-h<span class="token operator">&lt;</span>lines<span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span>vmid<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>interval<span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>count<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

Definitions:
  <span class="token operator">&lt;</span>option<span class="token operator">&gt;</span>      An option reported by the -options option
  <span class="token operator">&lt;</span>vmid<span class="token operator">&gt;</span>        Virtual Machine Identifier. A vmid takes the following form:
                     <span class="token operator">&lt;</span>lvmid<span class="token operator">&gt;</span><span class="token punctuation">[</span>@<span class="token operator">&lt;</span>hostname<span class="token operator">&gt;</span><span class="token punctuation">[</span>:<span class="token operator">&lt;</span>port<span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
                Where <span class="token operator">&lt;</span>lvmid<span class="token operator">&gt;</span> is the <span class="token builtin class-name">local</span> vm identifier <span class="token keyword">for</span> the target
                Java virtual machine, typically a process <span class="token function">id</span><span class="token punctuation">;</span> <span class="token operator">&lt;</span>hostname<span class="token operator">&gt;</span> is
                the name of the <span class="token function">host</span> running the target Java virtual machine<span class="token punctuation">;</span>
                and <span class="token operator">&lt;</span>port<span class="token operator">&gt;</span> is the port number <span class="token keyword">for</span> the rmiregistry on the
                target host. See the jvmstat documentation <span class="token keyword">for</span> a <span class="token function">more</span> complete
                description of the Virtual Machine Identifier.
  <span class="token operator">&lt;</span>lines<span class="token operator">&gt;</span>       Number of samples between header lines.
  <span class="token operator">&lt;</span>interval<span class="token operator">&gt;</span>    Sampling interval. The following forms are allowed:
                    <span class="token operator">&lt;</span>n<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token string">&quot;ms&quot;</span><span class="token operator">|</span><span class="token string">&quot;s&quot;</span><span class="token punctuation">]</span>
                Where <span class="token operator">&lt;</span>n<span class="token operator">&gt;</span> is an integer and the suffix specifies the <span class="token function">units</span> as
                milliseconds<span class="token punctuation">(</span><span class="token string">&quot;ms&quot;</span><span class="token punctuation">)</span> or seconds<span class="token punctuation">(</span><span class="token string">&quot;s&quot;</span><span class="token punctuation">)</span>. The default <span class="token function">units</span> are <span class="token string">&quot;ms&quot;</span><span class="token builtin class-name">.</span>
  <span class="token operator">&lt;</span>count<span class="token operator">&gt;</span>       Number of samples to take before terminating.
  -J<span class="token operator">&lt;</span>flag<span class="token operator">&gt;</span>      Pass <span class="token operator">&lt;</span>flag<span class="token operator">&gt;</span> directly to the runtime system.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><ul><li>-t：timestamp，显示系统运行时间</li> <li>-h：在周期性显示数据时，指定间隔多少行（lines）输出一次表头</li> <li>vmid：进程 ID</li> <li>interval：间隔时间，单位毫秒</li> <li>count：指定输出次数，缺省则一直输出</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ jstat -options
-class              <span class="token comment"># 显示类加载 ClassLoad 的相关信息</span>
-compiler           <span class="token comment"># 显示 JIT 编译的相关信息</span>
-gc                 <span class="token comment"># 显示 GC 相关堆信息</span>
-gccapacity         <span class="token comment"># 显示各个代的容量及使用情况</span>
-gccause            <span class="token comment"># 显示垃圾回收的相关信息（同 -gcutil），同时显示最后一次或当前正在发生的垃圾回收的原因</span>
-gcmetacapacity     <span class="token comment"># 显示元空间 metaspace 的大小</span>
-gcnew              <span class="token comment"># 显示新生代信息</span>
-gcnewcapacity      <span class="token comment"># 显示新生代大小和使用情况</span>
-gcold              <span class="token comment"># 显示老年代垃圾收集状况</span>
-gcoldcapacity      <span class="token comment"># 显示老年代的大小</span>
-gcutil             <span class="token comment"># 显示垃圾回收信息</span>
-printcompilation   <span class="token comment"># 输出 JIT 编译的方法信息</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="jinfo-配置信息"><a href="#jinfo-配置信息" class="header-anchor">#</a> JINFO 配置信息</h3> <p>JINFO：实时查看和调整虚拟机各项参数</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ jinfo -help
Usage:
    jinfo <span class="token punctuation">[</span>option<span class="token punctuation">]</span> <span class="token operator">&lt;</span>pid<span class="token operator">&gt;</span>
        <span class="token punctuation">(</span>to connect to running process<span class="token punctuation">)</span>
    jinfo <span class="token punctuation">[</span>option<span class="token punctuation">]</span> <span class="token operator">&lt;</span>executable <span class="token operator">&lt;</span>core<span class="token operator">&gt;</span>
        <span class="token punctuation">(</span>to connect to a core <span class="token function">file</span><span class="token punctuation">)</span>
    jinfo <span class="token punctuation">[</span>option<span class="token punctuation">]</span> <span class="token punctuation">[</span>server_id@<span class="token punctuation">]</span><span class="token operator">&lt;</span>remote server IP or hostname<span class="token operator">&gt;</span>
        <span class="token punctuation">(</span>to connect to remote debug server<span class="token punctuation">)</span>

where <span class="token operator">&lt;</span>option<span class="token operator">&gt;</span> is one of:
    -flag <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>         to print the value of the named VM flag
    -flag <span class="token punctuation">[</span>+<span class="token operator">|</span>-<span class="token punctuation">]</span><span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>    to <span class="token builtin class-name">enable</span> or disable the named VM flag
    -flag <span class="token operator">&lt;</span>name<span class="token operator">&gt;=</span><span class="token operator">&lt;</span>value<span class="token operator">&gt;</span> to <span class="token builtin class-name">set</span> the named VM flag to the given value
    -flags               to print VM flags
    -sysprops            to print Java system properties
    <span class="token operator">&lt;</span>no option<span class="token operator">&gt;</span>          to print both of the above
    -h <span class="token operator">|</span> -help           to print this <span class="token builtin class-name">help</span> message
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><code>java -XX:+PrintFlagsFinal -version</code>：会列出当前机器支持的所有 JVM 参数，只有<code>manageable</code>的参数才能实时调整</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ java -XX:+PrintFlagsFinal -version
<span class="token punctuation">[</span>Global flags<span class="token punctuation">]</span>
    <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
     bool PreserveFramePointer                      <span class="token operator">=</span> <span class="token boolean">false</span>                               <span class="token punctuation">{</span>pd product<span class="token punctuation">}</span>
     bool PrintGCApplicationConcurrentTime          <span class="token operator">=</span> <span class="token boolean">false</span>                               <span class="token punctuation">{</span>product<span class="token punctuation">}</span>
     bool PrintGCApplicationStoppedTime             <span class="token operator">=</span> <span class="token boolean">false</span>                               <span class="token punctuation">{</span>product<span class="token punctuation">}</span>
     bool PrintGCCause                              <span class="token operator">=</span> <span class="token boolean">true</span>                                <span class="token punctuation">{</span>product<span class="token punctuation">}</span>
     bool PrintGCDateStamps                         <span class="token operator">=</span> <span class="token boolean">false</span>                               <span class="token punctuation">{</span>manageable<span class="token punctuation">}</span>
     bool PrintGCDetails                            <span class="token operator">=</span> <span class="token boolean">false</span>                               <span class="token punctuation">{</span>manageable<span class="token punctuation">}</span>
     bool PrintGCID                                 <span class="token operator">=</span> <span class="token boolean">false</span>                               <span class="token punctuation">{</span>manageable<span class="token punctuation">}</span>
     bool PrintGCTaskTimeStamps                     <span class="token operator">=</span> <span class="token boolean">false</span>                               <span class="token punctuation">{</span>product<span class="token punctuation">}</span>
     bool PrintGCTimeStamps                         <span class="token operator">=</span> <span class="token boolean">false</span>                               <span class="token punctuation">{</span>manageable<span class="token punctuation">}</span>
     bool PrintHeapAtGC                             <span class="token operator">=</span> <span class="token boolean">false</span>                               <span class="token punctuation">{</span>product rw<span class="token punctuation">}</span>
    <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
java version <span class="token string">&quot;1.8.0_261&quot;</span>
Java<span class="token punctuation">(</span>TM<span class="token punctuation">)</span> SE Runtime Environment <span class="token punctuation">(</span>build <span class="token number">1.8</span>.0_261-b12<span class="token punctuation">)</span>
Java HotSpot<span class="token punctuation">(</span>TM<span class="token punctuation">)</span> <span class="token number">64</span>-Bit Server VM <span class="token punctuation">(</span>build <span class="token number">25.261</span>-b12, mixed mode<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="jmap-内存映像"><a href="#jmap-内存映像" class="header-anchor">#</a> JMAP 内存映像</h3> <p>JMAP：用于生成 Java 堆转储快照（HeapDump/Dump 文件），也可以查询 finalize 执行队列、Java 堆和方法区信息，如空间使用率、收集器信息等</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ jmap -help
Usage:
    jmap <span class="token punctuation">[</span>option<span class="token punctuation">]</span> <span class="token operator">&lt;</span>pid<span class="token operator">&gt;</span>
        <span class="token punctuation">(</span>to connect to running process<span class="token punctuation">)</span>
    jmap <span class="token punctuation">[</span>option<span class="token punctuation">]</span> <span class="token operator">&lt;</span>executable <span class="token operator">&lt;</span>core<span class="token operator">&gt;</span>
        <span class="token punctuation">(</span>to connect to a core <span class="token function">file</span><span class="token punctuation">)</span>
    jmap <span class="token punctuation">[</span>option<span class="token punctuation">]</span> <span class="token punctuation">[</span>server_id@<span class="token punctuation">]</span><span class="token operator">&lt;</span>remote server IP or hostname<span class="token operator">&gt;</span>
        <span class="token punctuation">(</span>to connect to remote debug server<span class="token punctuation">)</span>

where <span class="token operator">&lt;</span>option<span class="token operator">&gt;</span> is one of:
    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>               to print same info as Solaris pmap
    -heap                to print java heap summary
    -histo<span class="token punctuation">[</span>:live<span class="token punctuation">]</span>        to print histogram of java object heap<span class="token punctuation">;</span> <span class="token keyword">if</span> the <span class="token string">&quot;live&quot;</span>
                         suboption is specified, only count live objects
    -clstats             to print class loader statistics
    -finalizerinfo       to print information on objects awaiting finalization
    -dump:<span class="token operator">&lt;</span>dump-options<span class="token operator">&gt;</span> to dump java heap <span class="token keyword">in</span> hprof binary <span class="token function">format</span>
                         dump-options:
                           live         dump only live objects<span class="token punctuation">;</span> <span class="token keyword">if</span> not specified,
                                        all objects <span class="token keyword">in</span> the heap are dumped.
                           <span class="token assign-left variable">format</span><span class="token operator">=</span>b     binary <span class="token function">format</span>
                           <span class="token assign-left variable">file</span><span class="token operator">=</span><span class="token operator">&lt;</span>file<span class="token operator">&gt;</span>  dump heap to <span class="token operator">&lt;</span>file<span class="token operator">&gt;</span>
                         Example: jmap -dump:live,format<span class="token operator">=</span>b,file<span class="token operator">=</span>heap.bin <span class="token operator">&lt;</span>pid<span class="token operator">&gt;</span>
    -F                   force. Use with -dump:<span class="token operator">&lt;</span>dump-options<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>pid<span class="token operator">&gt;</span> or -histo
                         to force a heap dump or histogram when <span class="token operator">&lt;</span>pid<span class="token operator">&gt;</span> does not
                         respond. The <span class="token string">&quot;live&quot;</span> suboption is not supported
                         <span class="token keyword">in</span> this mode.
    -h <span class="token operator">|</span> -help           to print this <span class="token builtin class-name">help</span> message
    -J<span class="token operator">&lt;</span>flag<span class="token operator">&gt;</span>             to pass <span class="token operator">&lt;</span>flag<span class="token operator">&gt;</span> directly to the runtime system
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><ul><li>-dump：生成 Java 堆转储快照，其中 <code>live</code> 表示是否只 dump 出存活对象</li> <li>-finalizerinfo：显示在 F-Queue 中等待 Finalizer 线程执行 finalize 方法的对象</li> <li>-heap：显示 Java 堆详细信息，如使用哪种回收器、参数配置、分代状况等</li> <li>-histo：显示堆中对象统计信息，包括类、实例数量、合计容量</li> <li>-clstats：以 ClassLoader 为统计口径显示永久代内存状态</li> <li>-F：当虚拟机进程对 -dump 选项没有响应时，可使用这个选项强制生成 dump 快照</li></ul> <h3 id="jhat-堆转储快照分析"><a href="#jhat-堆转储快照分析" class="header-anchor">#</a> JHAT 堆转储快照分析</h3> <p>JHAT：分析 Java 堆转储快照，内置了一个微型的 HTTP/HTML 服务器，生成快照分析结果后，可视化查看</p> <h3 id="jstack-堆栈跟踪"><a href="#jstack-堆栈跟踪" class="header-anchor">#</a> JSTACK 堆栈跟踪</h3> <p>JSTACK：生成当前虚拟机线程快照（线程的方法堆栈集合），定位线程死锁、死循环、长事件等待等原因</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ jstack -help
Usage:
    jstack <span class="token punctuation">[</span>-l<span class="token punctuation">]</span> <span class="token operator">&lt;</span>pid<span class="token operator">&gt;</span>
        <span class="token punctuation">(</span>to connect to running process<span class="token punctuation">)</span>
    jstack -F <span class="token punctuation">[</span>-m<span class="token punctuation">]</span> <span class="token punctuation">[</span>-l<span class="token punctuation">]</span> <span class="token operator">&lt;</span>pid<span class="token operator">&gt;</span>
        <span class="token punctuation">(</span>to connect to a hung process<span class="token punctuation">)</span>
    jstack <span class="token punctuation">[</span>-m<span class="token punctuation">]</span> <span class="token punctuation">[</span>-l<span class="token punctuation">]</span> <span class="token operator">&lt;</span>executable<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>core<span class="token operator">&gt;</span>
        <span class="token punctuation">(</span>to connect to a core <span class="token function">file</span><span class="token punctuation">)</span>
    jstack <span class="token punctuation">[</span>-m<span class="token punctuation">]</span> <span class="token punctuation">[</span>-l<span class="token punctuation">]</span> <span class="token punctuation">[</span>server_id@<span class="token punctuation">]</span><span class="token operator">&lt;</span>remote server IP or hostname<span class="token operator">&gt;</span>
        <span class="token punctuation">(</span>to connect to a remote debug server<span class="token punctuation">)</span>

Options:
    -F  to force a thread dump. Use when jstack <span class="token operator">&lt;</span>pid<span class="token operator">&gt;</span> does not respond <span class="token punctuation">(</span>process is hung<span class="token punctuation">)</span>
    -m  to print both java and native frames <span class="token punctuation">(</span>mixed mode<span class="token punctuation">)</span>
    -l  long listing. Prints additional information about locks
    -h or -help to print this <span class="token builtin class-name">help</span> message
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ul><li>-F：当正常输出请求不被响应时，强制输出线程堆栈</li> <li>-l：输出锁信息</li> <li>-m：如果调用到本地方法，可以显示 C/C++ 堆栈</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2022/6/8</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/kr/java/jvm/类加载机制.html" class="prev">
          类加载机制
        </a></span> <span class="next"><a href="/kr/java/juc/juc.html">
          JUC
        </a>
        →
      </span></p></div> </main></div> <aside class="page-sidebar"> <div class="page-side-toolbar"><div class="option-box-toc-fixed"><div class="toc-container-sidebar"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:650px"><div style="font-weight:bold;text-align:center;">JVM 工具应用</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/kr/java/jvm/JVM-%E5%B7%A5%E5%85%B7%E5%BA%94%E7%94%A8.html#jdk-故障处理工具" class="toc-sidebar-link">JDK 故障处理工具</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/kr/java/jvm/JVM-%E5%B7%A5%E5%85%B7%E5%BA%94%E7%94%A8.html#jps-进程监控" class="toc-sidebar-link">JPS 进程监控</a></li><li class="toc-sidebar-sub-header"><a href="/kr/java/jvm/JVM-%E5%B7%A5%E5%85%B7%E5%BA%94%E7%94%A8.html#jstat-统计信息" class="toc-sidebar-link">JSTAT 统计信息</a></li><li class="toc-sidebar-sub-header"><a href="/kr/java/jvm/JVM-%E5%B7%A5%E5%85%B7%E5%BA%94%E7%94%A8.html#jinfo-配置信息" class="toc-sidebar-link">JINFO 配置信息</a></li><li class="toc-sidebar-sub-header"><a href="/kr/java/jvm/JVM-%E5%B7%A5%E5%85%B7%E5%BA%94%E7%94%A8.html#jmap-内存映像" class="toc-sidebar-link">JMAP 内存映像</a></li><li class="toc-sidebar-sub-header"><a href="/kr/java/jvm/JVM-%E5%B7%A5%E5%85%B7%E5%BA%94%E7%94%A8.html#jhat-堆转储快照分析" class="toc-sidebar-link">JHAT 堆转储快照分析</a></li><li class="toc-sidebar-sub-header"><a href="/kr/java/jvm/JVM-%E5%B7%A5%E5%85%B7%E5%BA%94%E7%94%A8.html#jstack-堆栈跟踪" class="toc-sidebar-link">JSTACK 堆栈跟踪</a></li></ul></li></ul></div></div></div></div></div> <div class="option-box-toc-over"><img src="/images/system/toc.png" class="nozoom"> <span class="show-txt">目录</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:550px"><div style="font-weight:bold;text-align:center;">JVM 工具应用</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/kr/java/jvm/JVM-%E5%B7%A5%E5%85%B7%E5%BA%94%E7%94%A8.html#jdk-故障处理工具" class="toc-sidebar-link">JDK 故障处理工具</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/kr/java/jvm/JVM-%E5%B7%A5%E5%85%B7%E5%BA%94%E7%94%A8.html#jps-进程监控" class="toc-sidebar-link">JPS 进程监控</a></li><li class="toc-sidebar-sub-header"><a href="/kr/java/jvm/JVM-%E5%B7%A5%E5%85%B7%E5%BA%94%E7%94%A8.html#jstat-统计信息" class="toc-sidebar-link">JSTAT 统计信息</a></li><li class="toc-sidebar-sub-header"><a href="/kr/java/jvm/JVM-%E5%B7%A5%E5%85%B7%E5%BA%94%E7%94%A8.html#jinfo-配置信息" class="toc-sidebar-link">JINFO 配置信息</a></li><li class="toc-sidebar-sub-header"><a href="/kr/java/jvm/JVM-%E5%B7%A5%E5%85%B7%E5%BA%94%E7%94%A8.html#jmap-内存映像" class="toc-sidebar-link">JMAP 内存映像</a></li><li class="toc-sidebar-sub-header"><a href="/kr/java/jvm/JVM-%E5%B7%A5%E5%85%B7%E5%BA%94%E7%94%A8.html#jhat-堆转储快照分析" class="toc-sidebar-link">JHAT 堆转储快照分析</a></li><li class="toc-sidebar-sub-header"><a href="/kr/java/jvm/JVM-%E5%B7%A5%E5%85%B7%E5%BA%94%E7%94%A8.html#jstack-堆栈跟踪" class="toc-sidebar-link">JSTACK 堆栈跟踪</a></li></ul></li></ul></div></div></div></div></div></div>  </aside></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.cfd60917.js" defer></script><script src="/assets/js/4.8234885e.js" defer></script><script src="/assets/js/3.1429892b.js" defer></script><script src="/assets/js/45.c31e6474.js" defer></script>
  </body>
</html>
