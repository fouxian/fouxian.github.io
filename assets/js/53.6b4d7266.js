(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{509:function(e,t,a){"use strict";a.r(t);var i=a(34),r=Object(i.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"kafka-时间轮与延时操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kafka-时间轮与延时操作"}},[e._v("#")]),e._v(" Kafka 时间轮与延时操作")]),e._v(" "),a("blockquote",[a("p",[e._v("JDK 中 Timer/DelayQueue 的插入和删除操作的平均时间复杂度为 O(nlogn)，并不能满足 Kafka 的高性能要求，而基于时间轮可以将插入和删除操作的时间复杂度都降为 O(1)")])]),e._v(" "),a("p",[e._v("基于时间轮的概念，Kafka 自定义实现了一个用于延时功能的定时器（SystemTimer）")]),e._v(" "),a("p",[a("img",{attrs:{src:"/images/kr/kafka/Kafka-%E6%97%B6%E9%97%B4%E8%BD%AE%E7%BB%93%E6%9E%84.jpg",alt:"Kafka-时间轮结构"}})]),e._v(" "),a("ul",[a("li",[e._v("时间轮(TimingWheel)：是一个存储定时任务的环形队列，基于数组实现，数组中每个元素可以存放一个定时任务列表(TimerTaskList)")]),e._v(" "),a("li",[e._v("定时任务列表(TimerTaskList)：是一个环形双向链表，链表中每一项都是定时任务项(TimerTaskEntry)，其中封装了真正的定时任务(TimerTask)")]),e._v(" "),a("li",[e._v("基本时间跨度(tickMs)：时间轮每个时间格代表一个基本时间跨度，时间格个数(wheelSize)是固定的")]),e._v(" "),a("li",[e._v("时间轮的总体时间跨度(interval) = tickMs × wheelSize")]),e._v(" "),a("li",[e._v("表盘指针(currentTime)：表示时间轮当前所处的时间，是 tickMs 的整数倍")]),e._v(" "),a("li",[e._v("currentTime 可以将整个时间轮划分为到期部分和未到期部分，currentTime 当前指向的时间格也属于到期部分，表示刚好到期，需要处理此时间格所对应的 TimerTaskList 中的所有任务")])])])}),[],!1,null,null,null);t.default=r.exports}}]);