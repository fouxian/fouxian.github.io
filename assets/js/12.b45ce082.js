(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{472:function(a,s,t){"use strict";t.r(s);var n=t(34),e=Object(n.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"azkaban-编译镜像及基本使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#azkaban-编译镜像及基本使用"}},[a._v("#")]),a._v(" Azkaban 编译镜像及基本使用")]),a._v(" "),t("blockquote",[t("p",[a._v("一个完整的大数据分析系统，必然由很多任务单元 (如数据收集、数据清洗、数据存储、数据分析等) 组成，所有的任务单元及其之间的依赖关系组成了复杂的工作流，由 Azkaban/Oozie 工作流调度系统完成工作流管理")])]),a._v(" "),t("p",[a._v("Azkaban/Oozie 工作流调度系统，主要区别：")]),a._v(" "),t("ul",[t("li",[a._v("两者均可以调度/定时执行 Linux 命令、MapReduce、Spark、Pig、Java、Hive 等工作流任务")]),a._v(" "),t("li",[a._v("工作流定义\n"),t("ul",[t("li",[a._v("Azkaban 使用 Properties(Flow 1.0) 和 YAML(Flow 2.0) 文件定义工作流")]),a._v(" "),t("li",[a._v("Oozie 使用 Hadoop 流程定义语言(HPDL，XML 流程定义语言)来描述工作流")])])]),a._v(" "),t("li",[a._v("Azkaban 有较严格的权限控制，Oozie 暂无严格的权限控制")]),a._v(" "),t("li",[a._v("Azkaban 3.x 提供了两种运行模式：\n"),t("ul",[t("li",[a._v("单服务模式：元数据默认存放在内置 H2 数据库，该模式中 webServer(管理服务器) 和 executorServer(执行服务器) 运行在同一个进程中，进程名是 AzkabanSingleServer，该模式适用于小规模工作流的调度")]),a._v(" "),t("li",[a._v("分布式多服务模式：存放元数据数据库为 MySQL，MySQL 应采用主从模式进行备份和容错。这种模式下 webServer 和 executorServer 在不同进程中运行，彼此之间互不影响，适合用于生产环境")])])]),a._v(" "),t("li",[a._v("Oozie 默认使用 derby 存储工作流的元数据")])]),a._v(" "),t("p",[a._v("Azkaban 产生于 LinkedIn，并经过多年生产环境的检验，具备以下功能：")]),a._v(" "),t("ul",[t("li",[a._v("兼容任何版本的 Hadoop")]),a._v(" "),t("li",[a._v("易于使用的 Web UI")]),a._v(" "),t("li",[a._v("可以使用简单的 Web 页面进行工作流上传")]),a._v(" "),t("li",[a._v("支持按项目进行独立管理")]),a._v(" "),t("li",[a._v("定时任务调度")]),a._v(" "),t("li",[a._v("模块化和可插入")]),a._v(" "),t("li",[a._v("身份验证和授权")]),a._v(" "),t("li",[a._v("跟踪用户操作")]),a._v(" "),t("li",[a._v("支持失败和成功的电子邮件提醒")]),a._v(" "),t("li",[a._v("SLA 警报和自动查杀失败任务")]),a._v(" "),t("li",[a._v("重试失败的任务")])]),a._v(" "),t("h2",{attrs:{id:"azkaban-编译镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#azkaban-编译镜像"}},[a._v("#")]),a._v(" Azkaban 编译镜像")]),a._v(" "),t("div",{staticClass:"language-Dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" xzx/jdk-1.8")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("RUN")]),a._v(" wget -nv https://github.com/azkaban/azkaban/archive/4.0.0.tar.gz && "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("\\")]),a._v("\n        tar -zxvf 4.0.0.tar.gz -C /usr/local > /dev/null && "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("\\")]),a._v("\n        rm 4.0.0.tar.gz")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("RUN")]),a._v(" wget -nv -P /usr/local/azkaban-4.0.0/gradle/wrapper/ https://services.gradle.org/distributions/gradle-4.6-all.zip --no-check-certificate")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("COPY")]),a._v(" gradle-wrapper.properties /usr/local/azkaban-4.0.0/gradle/wrapper/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 修改 restli 版本号，这三个依赖在中央仓库不存在")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("COPY")]),a._v(" build.gradle /usr/local/azkaban-4.0.0/")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("RUN")]),a._v(" yum -y install git")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 切换目录，以后各层都在当前工作目录下，进入容器默认是该目录")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WORKDIR")]),a._v(" /usr/local/azkaban-4.0.0")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 构建编译")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("RUN")]),a._v(" ./gradlew build installDist -x test")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" build -t "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'xzx/azkaban-4.0.0'")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 构建镜像")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run -itd --restart"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("no --net"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("xzx-hadoop-bridge --privileged "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动容器")]),a._v("\n                -p "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8081")]),a._v(":8081 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n                --name xzx-azkaban "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n                --hostname xzx-azkaban "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n                xzx/azkaban-4.0.0\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" -zxvf azkaban-solo-server-0.1.0-SNAPSHOT.tar.gz     "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进入容器解压")]),a._v("\ndefault.timezone.id"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("America/Los_Angeles "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" Asia/Shanghai "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 修改配置文件 conf/azkaban.Properties 时区")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@xzx-azkaban azkaban-solo-server-0.1.0-SNAPSHOT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# bin/start-solo.sh  # 启动单服务模式")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@xzx-azkaban azkaban-solo-server-0.1.0-SNAPSHOT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# jps")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("48")]),a._v(" AzkabanSingleServer\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("71")]),a._v(" Jps\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br")])]),t("p",[a._v("Azkaban 的基本使用，参考：\n"),t("a",{attrs:{href:"https://github.com/heibaiying/BigData-Notes/blob/master/notes/Azkaban_Flow_1.0_%E7%9A%84%E4%BD%BF%E7%94%A8.md",target:"_blank",rel:"noopener noreferrer"}},[a._v("Azkaban Flow 1.0 的基本使用"),t("OutboundLink")],1),a._v(" "),t("a",{attrs:{href:"https://github.com/heibaiying/BigData-Notes/blob/master/notes/Azkaban_Flow_2.0_%E7%9A%84%E4%BD%BF%E7%94%A8.md",target:"_blank",rel:"noopener noreferrer"}},[a._v("Azkaban Flow 2.0 的基本使用"),t("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);