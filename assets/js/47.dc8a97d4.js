(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{504:function(a,s,t){"use strict";t.r(s);var e=t(34),n=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"自动内存管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自动内存管理"}},[a._v("#")]),a._v(" 自动内存管理")]),a._v(" "),t("h2",{attrs:{id:"运行时数据区"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行时数据区"}},[a._v("#")]),a._v(" 运行时数据区")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/java/jvm/%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA.png",alt:"运行时数据区"}})]),a._v(" "),t("h2",{attrs:{id:"hotspot-虚拟机对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hotspot-虚拟机对象"}},[a._v("#")]),a._v(" HotSpot-虚拟机对象")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/java/jvm/HotSpot-%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AF%B9%E8%B1%A1.png",alt:"HotSpot-虚拟机对象"}})]),a._v(" "),t("blockquote",[t("p",[a._v("虚拟机是否使用"),t("code",[a._v("TLAB 本地线程分配缓冲")]),a._v("可通过设置"),t("code",[a._v("-XX:+/-UseTLAB")]),a._v("参数来指定，JDK8 默认开启")])]),a._v(" "),t("h2",{attrs:{id:"堆内存回收"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#堆内存回收"}},[a._v("#")]),a._v(" 堆内存回收")]),a._v(" "),t("blockquote",[t("p",[a._v("一般说的内存回收主要指的是堆内存中的对象回收")])]),a._v(" "),t("h3",{attrs:{id:"对象已死"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#对象已死"}},[a._v("#")]),a._v(" 对象已死？")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/java/jvm/%E5%AF%B9%E8%B1%A1%E5%B7%B2%E6%AD%BB.png",alt:"对象已死"}})]),a._v(" "),t("h3",{attrs:{id:"引用关系"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#引用关系"}},[a._v("#")]),a._v(" 引用关系")]),a._v(" "),t("blockquote",[t("p",[t("code",[a._v("引用计数算法")]),a._v("或"),t("code",[a._v("可达性分析算法")]),a._v("都是基于对象的引用关系计算对象的被引用情况，从而判断对象是否存活")]),a._v(" "),t("p",[a._v("Java 的数据类型："),t("code",[a._v("基本数据类型")]),a._v("和"),t("code",[a._v("引用数据类型")]),a._v("，引用数据类型通过某个符号（引用变量/引用指针）指向某个对象")])]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/java/jvm/%E5%BC%95%E7%94%A8%E5%85%B3%E7%B3%BB.png",alt:"引用关系"}})]),a._v(" "),t("blockquote",[t("p",[a._v("Java 允许使用 finalize() 方法在垃圾收集器回收对象前做必要工作，虚引用的主要作用是跟踪对象垃圾回收的状态，\n用来实现比 finalization 通知机制更灵活的回收通知操作，虚引用无法访问对象实例")])]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/java/jvm/Reference.png",alt:"Reference"}}),a._v(" "),t("code",[a._v("java.lang.ref.Reference")]),a._v(" 的 4 种状态：")]),a._v(" "),t("ul",[t("li",[a._v("Active：新创建引用实例处于 Active 状态，当 GC 检测到该实例所引用的对象不可达时，状态将发生变化：\n"),t("ul",[t("li",[a._v("如果 Reference 注册了 ReferenceQueue，则切换为 Pending 状态，且 Reference 会加入 Pending-Reference 链表中")]),a._v(" "),t("li",[a._v("如果没有注册 ReferenceQueue，则切换为 Inactive 状态")])])]),a._v(" "),t("li",[a._v("Pending：当引用实例处于 Pending-Reference 链表中时，为 Pending 状态\n"),t("ul",[t("li",[a._v("此时该实例在等待 Reference-Handler 线程进行 Enqueue 操作，加入 ReferenceQueue 中")]),a._v(" "),t("li",[a._v("如果某个引用实例没有注册在一个引用队列中，该实例永远不会进入 Pending 状态")])])]),a._v(" "),t("li",[a._v("Enqueued：在 ReferenceQueue 队列中的 Reference 的状态，若 Reference 从队列中移除，会进入 Inactive 状态")]),a._v(" "),t("li",[a._v("Inactive：一旦某个引用实例处于 Inactive 状态，其状态不再改变，即该引用实例所指向的对象一定会被回收")])]),a._v(" "),t("h3",{attrs:{id:"对象回收过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#对象回收过程"}},[a._v("#")]),a._v(" 对象回收过程")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/java/jvm/%E5%AF%B9%E8%B1%A1%E5%9B%9E%E6%94%B6%E8%BF%87%E7%A8%8B.png",alt:"对象回收过程"}})]),a._v(" "),t("blockquote",[t("p",[a._v("如果第一次执行 finalize 方法此对象变成了可达确实不会回收，但如果对象再次被 GC，则会忽略 finalize 方法，对象会被回收")])]),a._v(" "),t("h3",{attrs:{id:"垃圾收集算法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#垃圾收集算法"}},[a._v("#")]),a._v(" 垃圾收集算法")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/java/jvm/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E7%AE%97%E6%B3%95.png",alt:"垃圾收集算法"}})]),a._v(" "),t("h3",{attrs:{id:"分代收集理论"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#分代收集理论"}},[a._v("#")]),a._v(" 分代收集理论")]),a._v(" "),t("blockquote",[t("p",[a._v("分代收集理论根据分代假说综合应用了多种垃圾收集算法的优点")])]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/java/jvm/%E5%88%86%E4%BB%A3%E6%94%B6%E9%9B%86%E7%90%86%E8%AE%BA.png",alt:"分代收集理论"}})]),a._v(" "),t("h3",{attrs:{id:"垃圾收集类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#垃圾收集类型"}},[a._v("#")]),a._v(" 垃圾收集类型")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/java/jvm/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E7%B1%BB%E5%9E%8B.png",alt:"垃圾收集类型"}})]),a._v(" "),t("blockquote",[t("p",[a._v("Stop The World（STW）：在 GC（Minor GC 或 Full GC）期间，用户线程会被挂起，以便正确标记对象的状态是垃圾还是非垃圾")])]),a._v(" "),t("h3",{attrs:{id:"垃圾收集器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#垃圾收集器"}},[a._v("#")]),a._v(" 垃圾收集器")]),a._v(" "),t("ul",[t("li",[a._v("在新生代工作的垃圾回收器：Serial、ParNew、Parallel Scavenge")]),a._v(" "),t("li",[a._v("在老年代工作的垃圾回收器：Serial Old、Parallel Old、CMS")]),a._v(" "),t("li",[a._v("同时在新生代和老年代工作的垃圾回收器：G1")])]),a._v(" "),t("blockquote",[t("p",[a._v("Java8 默认使用 Parallel Scavenge + Parallel Old 组合，Java9 开始使用 G1 收集器")])]),a._v(" "),t("h4",{attrs:{id:"串行收集器-serial"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#串行收集器-serial"}},[a._v("#")]),a._v(" 串行收集器-Serial")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/java/jvm/%E4%B8%B2%E8%A1%8C%E6%94%B6%E9%9B%86%E5%99%A8-Serial.png",alt:"串行收集器-Serial"}}),a._v("\nSerial/Serial Old，单线程收集器，Serial 是 Client 模式下默认新生代收集器，Serial Old 是对应的老年代收集器")]),a._v(" "),t("h4",{attrs:{id:"并行收集器-parnew"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#并行收集器-parnew"}},[a._v("#")]),a._v(" 并行收集器-ParNew")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/java/jvm/%E5%B9%B6%E8%A1%8C%E6%94%B6%E9%9B%86%E5%99%A8-ParNew.png",alt:"并行收集器-ParNew"}}),a._v("\nParNew 是 Serial 的多线程版本，是 Server 模式下首选新生代收集器，除 Serial 外，只有它能与 CMS 配合工作")]),a._v(" "),t("h4",{attrs:{id:"并行收集器-parallel-scavenge-parallel-old"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#并行收集器-parallel-scavenge-parallel-old"}},[a._v("#")]),a._v(" 并行收集器-Parallel Scavenge/Parallel Old")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/java/jvm/%E5%B9%B6%E8%A1%8C%E6%94%B6%E9%9B%86%E5%99%A8-Parallel.png",alt:"并行收集器-Parallel"}}),a._v("\nParallel Scavenge 新生代收集器，使用标记-复制算法；Parallel Old 老生代收集器，使用标记-整理算法。\nParallel Scavenge/Parallel Old 为吞吐量优先收集器，其关注点：")]),a._v(" "),t("ul",[t("li",[a._v("吞吐量优先收集器的目标是达到一个可控制的吞吐量（吞吐量 = 运行用户代码时间 / (运行用户代码时间 + 垃圾收集时间)）")]),a._v(" "),t("li",[a._v("高吞吐量可最高效率利用处理器资源，适合后台运算而不需要太多交互的分析任务")])]),a._v(" "),t("blockquote",[t("p",[a._v("垃圾收集的自适应调节策略：根据当前系统运行性能，动态调整参数以提供最合适停顿时间或最大吞吐量")])]),a._v(" "),t("h4",{attrs:{id:"并发收集器-cms"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#并发收集器-cms"}},[a._v("#")]),a._v(" 并发收集器-CMS")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/java/jvm/CMS-%E6%94%B6%E9%9B%86%E5%99%A8.png",alt:"CMS-收集器"}}),a._v(" "),t("img",{attrs:{src:"/images/kr/java/jvm/CMS-%E6%94%B6%E9%9B%86%E5%99%A82.png",alt:"CMS-收集器"}})]),a._v(" "),t("h4",{attrs:{id:"并发收集器-g1-分区收集"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#并发收集器-g1-分区收集"}},[a._v("#")]),a._v(" 并发收集器-G1（分区收集）")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/java/jvm/G1-%E6%94%B6%E9%9B%86%E5%99%A8.png",alt:"G1-收集器"}}),a._v(" "),t("img",{attrs:{src:"/images/kr/java/jvm/G1-%E6%94%B6%E9%9B%86%E5%99%A82.png",alt:"G1-收集器"}}),a._v(" "),t("img",{attrs:{src:"/images/kr/java/jvm/G1-%E6%94%B6%E9%9B%86%E5%99%A83.png",alt:"G1-收集器3"}}),a._v("\n注：图片来自："),t("a",{attrs:{href:"https://blog.csdn.net/weixin_41300437/article/details/118636783",target:"_blank",rel:"noopener noreferrer"}},[a._v("JVM垃圾回收算法及JVM垃圾收集器"),t("OutboundLink")],1)]),a._v(" "),t("h2",{attrs:{id:"方法区回收"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#方法区回收"}},[a._v("#")]),a._v(" 方法区回收")]),a._v(" "),t("blockquote",[t("p",[a._v("方法区回收主要回收废弃常量和无用的类")])]),a._v(" "),t("h2",{attrs:{id:"jvm-参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jvm-参数"}},[a._v("#")]),a._v(" JVM 参数")]),a._v(" "),t("ul",[t("li",[a._v("标准参数（-）：所有 JVM 的实现版本都必须实现这些参数，向后兼容")]),a._v(" "),t("li",[a._v("非标准参数（-X）：默认 JVM 实现这些参数，但并不保证所有 JVM 实现版本都满足，且不保证向后兼容")]),a._v(" "),t("li",[a._v("非 Stable 参数（-XX）：此类参数各个 JVM 实现会有所不同，将来可能会随时取消，需慎重使用")])]),a._v(" "),t("h3",{attrs:{id:"标准参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#标准参数"}},[a._v("#")]),a._v(" 标准参数（-）")]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("$ java\n用法: java "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("-options"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" class "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n           "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("执行类"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n   或  java "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("-options"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" -jar jarfile "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n           "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("执行 jar 文件"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n其中选项包括:\n    -d32          使用 "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("32")]),a._v(" 位数据模型 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("如果可用"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    -d64          使用 "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("64")]),a._v(" 位数据模型 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("如果可用"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    -server       选择 "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"server"')]),a._v(" VM\n                  默认 VM 是 server.\n\n    -cp "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("目录和 zip/jar 文件的类搜索路径"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n    -classpath "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("目录和 zip/jar 文件的类搜索路径"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n                  用 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" 分隔的目录, JAR 档案\n                  和 ZIP 档案列表, 用于搜索类文件。\n    -D"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("名称"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("值"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n                  设置系统属性\n    -verbose:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("class"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("gc"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("jni"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n                  启用详细输出\n    -version      输出产品版本并退出\n    -version:"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("值"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n                  警告: 此功能已过时, 将在\n                  未来发行版中删除。\n                  需要指定的版本才能运行\n    -showversion  输出产品版本并继续\n    -jre-restrict-search "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" -no-jre-restrict-search\n                  警告: 此功能已过时, 将在\n                  未来发行版中删除。\n                  在版本搜索中包括/排除用户专用 JRE\n    -? -help      输出此帮助消息\n    -X            输出非标准选项的帮助\n    -ea"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(":"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("packagename"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(":"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("classname"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n    -enableassertions"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(":"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("packagename"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(":"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("classname"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n                  按指定的粒度启用断言\n    -da"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(":"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("packagename"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(":"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("classname"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n    -disableassertions"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(":"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("packagename"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("."),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(":"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("classname"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n                  禁用具有指定粒度的断言\n    -esa "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" -enablesystemassertions\n                  启用系统断言\n    -dsa "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" -disablesystemassertions\n                  禁用系统断言\n    -agentlib:"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("libname"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("选项"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n                  加载本机代理库 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("libname"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(", 例如 -agentlib:hprof\n                  另请参阅 -agentlib:jdwp"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("help 和 -agentlib:hprof"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("help\n    -agentpath:"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("pathname"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("选项"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n                  按完整路径名加载本机代理库\n    -javaagent:"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("jarpath"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("选项"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n                  加载 Java 编程语言代理, 请参阅 java.lang.instrument\n    -splash:"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("imagepath"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n                  使用指定的图像显示启动屏幕\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br"),t("span",{staticClass:"line-number"},[a._v("15")]),t("br"),t("span",{staticClass:"line-number"},[a._v("16")]),t("br"),t("span",{staticClass:"line-number"},[a._v("17")]),t("br"),t("span",{staticClass:"line-number"},[a._v("18")]),t("br"),t("span",{staticClass:"line-number"},[a._v("19")]),t("br"),t("span",{staticClass:"line-number"},[a._v("20")]),t("br"),t("span",{staticClass:"line-number"},[a._v("21")]),t("br"),t("span",{staticClass:"line-number"},[a._v("22")]),t("br"),t("span",{staticClass:"line-number"},[a._v("23")]),t("br"),t("span",{staticClass:"line-number"},[a._v("24")]),t("br"),t("span",{staticClass:"line-number"},[a._v("25")]),t("br"),t("span",{staticClass:"line-number"},[a._v("26")]),t("br"),t("span",{staticClass:"line-number"},[a._v("27")]),t("br"),t("span",{staticClass:"line-number"},[a._v("28")]),t("br"),t("span",{staticClass:"line-number"},[a._v("29")]),t("br"),t("span",{staticClass:"line-number"},[a._v("30")]),t("br"),t("span",{staticClass:"line-number"},[a._v("31")]),t("br"),t("span",{staticClass:"line-number"},[a._v("32")]),t("br"),t("span",{staticClass:"line-number"},[a._v("33")]),t("br"),t("span",{staticClass:"line-number"},[a._v("34")]),t("br"),t("span",{staticClass:"line-number"},[a._v("35")]),t("br"),t("span",{staticClass:"line-number"},[a._v("36")]),t("br"),t("span",{staticClass:"line-number"},[a._v("37")]),t("br"),t("span",{staticClass:"line-number"},[a._v("38")]),t("br"),t("span",{staticClass:"line-number"},[a._v("39")]),t("br"),t("span",{staticClass:"line-number"},[a._v("40")]),t("br"),t("span",{staticClass:"line-number"},[a._v("41")]),t("br"),t("span",{staticClass:"line-number"},[a._v("42")]),t("br"),t("span",{staticClass:"line-number"},[a._v("43")]),t("br"),t("span",{staticClass:"line-number"},[a._v("44")]),t("br"),t("span",{staticClass:"line-number"},[a._v("45")]),t("br"),t("span",{staticClass:"line-number"},[a._v("46")]),t("br"),t("span",{staticClass:"line-number"},[a._v("47")]),t("br"),t("span",{staticClass:"line-number"},[a._v("48")]),t("br"),t("span",{staticClass:"line-number"},[a._v("49")]),t("br"),t("span",{staticClass:"line-number"},[a._v("50")]),t("br")])]),t("ul",[t("li",[a._v("-agentlib:libname[=options]：用于装载环境变量 PATH 中的本地代理库 lib 包")]),a._v(" "),t("li",[a._v("-agentpath:pathname[=options]：按指定全路径装载本地库，不再搜索 PATH 中的路径")]),a._v(" "),t("li",[a._v("-Dproperty=value：设置系统级全局变量，运行在此 JVM 之上的应用程序可用 "),t("code",[a._v('System.getProperty("property")')]),a._v("得到属性值")])]),a._v(" "),t("h3",{attrs:{id:"非标准参数-x"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#非标准参数-x"}},[a._v("#")]),a._v(" 非标准参数（-X）")]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("$ java -X\n    -Xmixed           混合模式执行（默认）\n    -Xint             仅解释模式执行\n    -Xbootclasspath:"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("用 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" 分隔的目录和 zip/jar 文件"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n                      设置引导类和资源的搜索路径\n    -Xbootclasspath/a:"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("用 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" 分隔的目录和 zip/jar 文件"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n                      附加在引导类路径末尾\n    -Xbootclasspath/p:"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("用 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" 分隔的目录和 zip/jar 文件"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n                      置于引导类路径之前\n    -Xdiag            显示附加诊断消息\n    -Xnoclassgc        禁用类垃圾收集\n    -Xincgc           启用增量垃圾收集\n    -Xloggc:"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("file"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("    将 GC 状态记录在文件中（带时间戳）\n    -Xbatch           禁用后台编译\n    -Xms"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("size"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("        设置初始 Java 堆大小\n    -Xmx"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("size"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("        设置最大 Java 堆大小\n    -Xss"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("size"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("        设置 Java 线程堆栈大小\n    -Xprof            输出 cpu 分析数据\n    -Xfuture          启用最严格的检查，预计会成为将来的默认值\n    -Xrs              减少 Java/VM 对操作系统信号的使用（请参阅文档）\n    -Xcheck:jni       对 JNI 函数执行其他检查\n    -Xshare:off       不尝试使用共享类数据\n    -Xshare:auto      在可能的情况下使用共享类数据（默认）\n    -Xshare:on        要求使用共享类数据，否则将失败。\n    -XshowSettings    显示所有设置并继续\n    -XshowSettings:system\n                      （仅限 Linux）显示系统或容器\n                      配置并继续\n    -XshowSettings:all\n                      显示所有设置并继续\n    -XshowSettings:vm 显示所有与 vm 相关的设置并继续\n    -XshowSettings:properties\n                      显示所有属性设置并继续\n    -XshowSettings:locale\n                      显示所有与区域设置相关的设置并继续\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br"),t("span",{staticClass:"line-number"},[a._v("15")]),t("br"),t("span",{staticClass:"line-number"},[a._v("16")]),t("br"),t("span",{staticClass:"line-number"},[a._v("17")]),t("br"),t("span",{staticClass:"line-number"},[a._v("18")]),t("br"),t("span",{staticClass:"line-number"},[a._v("19")]),t("br"),t("span",{staticClass:"line-number"},[a._v("20")]),t("br"),t("span",{staticClass:"line-number"},[a._v("21")]),t("br"),t("span",{staticClass:"line-number"},[a._v("22")]),t("br"),t("span",{staticClass:"line-number"},[a._v("23")]),t("br"),t("span",{staticClass:"line-number"},[a._v("24")]),t("br"),t("span",{staticClass:"line-number"},[a._v("25")]),t("br"),t("span",{staticClass:"line-number"},[a._v("26")]),t("br"),t("span",{staticClass:"line-number"},[a._v("27")]),t("br"),t("span",{staticClass:"line-number"},[a._v("28")]),t("br"),t("span",{staticClass:"line-number"},[a._v("29")]),t("br"),t("span",{staticClass:"line-number"},[a._v("30")]),t("br"),t("span",{staticClass:"line-number"},[a._v("31")]),t("br"),t("span",{staticClass:"line-number"},[a._v("32")]),t("br"),t("span",{staticClass:"line-number"},[a._v("33")]),t("br"),t("span",{staticClass:"line-number"},[a._v("34")]),t("br"),t("span",{staticClass:"line-number"},[a._v("35")]),t("br")])]),t("ul",[t("li",[a._v("-Xloggc:file：与"),t("code",[a._v("-verbose:gc")]),a._v("类似，只是将每次 GC 事件的相关情况记录到一个文件中，若与"),t("code",[a._v("verbose")]),a._v("命令同时出现，则以"),t("code",[a._v("-Xloggc")]),a._v("为准")]),a._v(" "),t("li",[a._v("-Xprof：跟踪正运行的程序，并将跟踪数据在标准输出输出；适合于开发环境调试")])]),a._v(" "),t("h3",{attrs:{id:"非-stable-参数-xx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#非-stable-参数-xx"}},[a._v("#")]),a._v(" 非 Stable 参数（-XX）")]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看 XX 参数的初始默认值，注：:= 说明参数有人为修改过或 JVM 加载修改")]),a._v("\n$ java -XX:+PrintFlagsInitial\n$ java -XX:+PrintFlagsInitial -version\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("\n     bool UseLWPSynchronization                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("                                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("product"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n     bool UseLargePages                             "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),a._v("                               "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("pd product"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n     bool UseLargePagesInMetaspace                  "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),a._v("                               "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("product"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n     bool UseLargePagesIndividualAllocation        :"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),a._v("                               "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("pd product"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n     bool UseLockedTracing                          "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),a._v("                               "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("product"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n     bool UseLoopCounter                            "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("                                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("product"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n     bool UseLoopInvariantCodeMotion                "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("                                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("C1 product"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n     bool UseLoopPredicate                          "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("                                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("C2 product"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n     bool UseMathExactIntrinsics                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("                                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("C2 product"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看参数修改更新")]),a._v("\n$ java -XX:+PrintFlagsFinal\n$ java -XX:+PrintFlagsFinal -version\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 打印命令行参数")]),a._v("\n$ java -XX:+PrintCommandLineFlags -version\n-XX:InitialHeapSize"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("265738560")]),a._v(" -XX:MaxHeapSize"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("4251816960")]),a._v(" -XX:+PrintCommandLineFlags -XX:+UseCompressedClassPointers \n-XX:+UseCompressedOops -XX:-UseLargePagesIndividualAllocation -XX:+UseParallelGC\njava version "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"1.8.0_261"')]),a._v("\nJava"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("TM"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" SE Runtime Environment "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("build "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.8")]),a._v(".0_261-b12"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nJava HotSpot"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("TM"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("64")]),a._v("-Bit Server VM "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("build "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("25.261")]),a._v("-b12, mixed mode"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br"),t("span",{staticClass:"line-number"},[a._v("15")]),t("br"),t("span",{staticClass:"line-number"},[a._v("16")]),t("br"),t("span",{staticClass:"line-number"},[a._v("17")]),t("br"),t("span",{staticClass:"line-number"},[a._v("18")]),t("br"),t("span",{staticClass:"line-number"},[a._v("19")]),t("br"),t("span",{staticClass:"line-number"},[a._v("20")]),t("br"),t("span",{staticClass:"line-number"},[a._v("21")]),t("br"),t("span",{staticClass:"line-number"},[a._v("22")]),t("br"),t("span",{staticClass:"line-number"},[a._v("23")]),t("br"),t("span",{staticClass:"line-number"},[a._v("24")]),t("br")])]),t("p",[a._v("XX 参数主要分为 Boolean 类型参数和 KV 类型参数：")]),a._v(" "),t("ul",[t("li",[a._v("Boolean："),t("code",[a._v("-XX:+option")]),a._v("/"),t("code",[a._v("-XX:-option")]),a._v("，（+ 表示开启，- 表示关闭），如："),t("code",[a._v("-XX:+PrintGCDetails")]),a._v("/"),t("code",[a._v("-XX:-PrintGCDetails")])]),a._v(" "),t("li",[a._v("KV：-XX:Key=Value，如："),t("code",[a._v("-Xms")]),a._v("等价于"),t("code",[a._v("-XX:InitialHeapSize")]),a._v("，"),t("code",[a._v("-Xmx")]),a._v("等价于"),t("code",[a._v("-XX:MaxHeapSize")])])]),a._v(" "),t("h3",{attrs:{id:"常用配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常用配置"}},[a._v("#")]),a._v(" 常用配置")]),a._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/java/jvm/JVM-%E5%86%85%E5%AD%98%E5%8F%82%E6%95%B0.png",alt:"JVM-内存参数"}})]),a._v(" "),t("h2",{attrs:{id:"gc-日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gc-日志"}},[a._v("#")]),a._v(" GC 日志")]),a._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("package")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[a._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("t")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("JvmGCLog")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" _1MB "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1024")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1024")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" d"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        a "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        b "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        c "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        d "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br")])]),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 使用默认的 Parallel Scavenge + Parallel Old 收集器")]),a._v("\n$ java -Xms20M -Xmx20M -Xmn10M -XX:+PrintGCDetails -XX:+PrintGCCause -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps x.t.JvmGCLog\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2022")]),a._v("-05-11T20:27:01.135+0800: "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.151")]),a._v(": "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("GC "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Allocation Failure"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("PSYoungGen: 6965K-"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("632K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("9216K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" 6965K-"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("6784K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("19456K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.0056997")]),a._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Times: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.00")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("sys")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.00")]),a._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("real")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.02")]),a._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2022")]),a._v("-05-11T20:27:01.150+0800: "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.157")]),a._v(": "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Full GC "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Ergonomics"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("PSYoungGen: 632K-"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("0K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("9216K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("ParOldGen: 6152K-"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("6664K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("10240K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" 6784K-"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("6664K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("19456K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Metaspace: 2554K-"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("2554K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("1056768K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.0107570")]),a._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Times: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.00")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("sys")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.00")]),a._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("real")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.01")]),a._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nHeap\n PSYoungGen      total 9216K, used 2212K "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("0x00000000ff600000, 0x0000000100000000, 0x0000000100000000"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n  eden space 8192K, "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("27")]),a._v("% used "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("0x00000000ff600000,0x00000000ff8290e0,0x00000000ffe00000"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n  from space 1024K, "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("% used "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("0x00000000ffe00000,0x00000000ffe00000,0x00000000fff00000"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n  to   space 1024K, "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("% used "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("0x00000000fff00000,0x00000000fff00000,0x0000000100000000"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n ParOldGen       total 10240K, used 6664K "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("0x00000000fec00000, 0x00000000ff600000, 0x00000000ff600000"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n  object space 10240K, "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("65")]),a._v("% used "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("0x00000000fec00000,0x00000000ff282320,0x00000000ff600000"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n Metaspace       used 2560K, capacity 4486K, committed 4864K, reserved 1056768K\n  class space    used 279K, capacity 386K, committed 512K, reserved 1048576K\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br")])]),t("p",[a._v("GC 日志格式解释：")]),a._v(" "),t("ul",[t("li",[a._v("2022-05-11T20:27:01.135+0800：GC 发生日期")]),a._v(" "),t("li",[a._v("0.151：GC 发生时间，表示从 JVM 启动以来经过的秒数")]),a._v(" "),t("li",[t("code",[a._v("GC")]),a._v("/"),t("code",[a._v("Full GC")]),a._v("：区分是 "),t("code",[a._v("Minor GC")]),a._v("、还是"),t("code",[a._v("Full GC")])]),a._v(" "),t("li",[t("code",[a._v("Allocation Failure")]),a._v("/"),t("code",[a._v("Ergonomics")]),a._v("：引起 GC 的原因")]),a._v(" "),t("li",[t("code",[a._v("PSYoungGen")]),a._v("/"),t("code",[a._v("ParOldGen")]),a._v("/"),t("code",[a._v("Metaspace")]),a._v("：GC 发生的区域，区域名称由收集器决定")]),a._v(" "),t("li",[a._v("6965K->632K(9216K)：表示「GC 前对应区域已使用容量 -> GC 后对应区域已使用容量(对应区域总容量)」")]),a._v(" "),t("li",[a._v("0.0056997 secs：对应区域或整个 Java 堆所 GC 持续时间，单位秒")]),a._v(" "),t("li",[a._v("[Times: user=0.00 sys=0.00, real=0.02 secs]：GC 持续时间，通过多种分类来进行衡量:\n"),t("ul",[t("li",[a._v("user：此次 GC，垃圾收集线程消耗的所有 CPU 时间（用户态耗时）")]),a._v(" "),t("li",[a._v("sys：操作系统调用及等待系统事件的时间（内核态耗时）")]),a._v(" "),t("li",[a._v("real：应用程序暂停的时间（总耗时）")])])])]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 使用 Serial 收集器")]),a._v("\n$ java -Xms20M -Xmx20M -Xmn10M -XX:+PrintGCDetails -XX:+PrintGCCause -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps -XX:+UseSerialGC x.t.JvmGCLog\n"),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2022")]),a._v("-05-11T20:55:29.194+0800: "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.138")]),a._v(": "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("GC "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Allocation Failure"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2022")]),a._v("-05-11T20:55:29.194+0800: "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.138")]),a._v(": "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("DefNew: 6965K-"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("521K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("9216K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.0079264")]),a._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" 6965K-"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("6665K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("19456K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(", "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.0080321")]),a._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Times: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.00")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("sys")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.00")]),a._v(", "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("real")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.01")]),a._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nHeap\n def new generation   total 9216K, used 2733K "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("0x00000000fec00000, 0x00000000ff600000, 0x00000000ff600000"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n  eden space 8192K,  "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("27")]),a._v("% used "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("0x00000000fec00000, 0x00000000fee290e0, 0x00000000ff400000"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n  from space 1024K,  "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("50")]),a._v("% used "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("0x00000000ff500000, 0x00000000ff582700, 0x00000000ff600000"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n  to   space 1024K,   "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("% used "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("0x00000000ff400000, 0x00000000ff400000, 0x00000000ff500000"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n tenured generation   total 10240K, used 6144K "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("0x00000000ff600000, 0x0000000100000000, 0x0000000100000000"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n   the space 10240K,  "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("60")]),a._v("% used "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("0x00000000ff600000, 0x00000000ffc00030, 0x00000000ffc00200, 0x0000000100000000"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n Metaspace       used 2560K, capacity 4486K, committed 4864K, reserved 1056768K\n  class space    used 279K, capacity 386K, committed 512K, reserved 1048576K\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br")])]),t("h2",{attrs:{id:"oom-场景与解决方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#oom-场景与解决方案"}},[a._v("#")]),a._v(" OOM 场景与解决方案")]),a._v(" "),t("blockquote",[t("p",[t("code",[a._v("StackOverflowError")]),a._v("和"),t("code",[a._v("OutOfMemoryError")]),a._v("都间接继承了 "),t("code",[a._v("Error")]),a._v(" 类")])]),a._v(" "),t("h3",{attrs:{id:"stackoverflowerror"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#stackoverflowerror"}},[a._v("#")]),a._v(" StackOverflowError")]),a._v(" "),t("p",[a._v("JVM 虚拟机栈是有深度的，执行方法时伴随着栈帧入栈和出栈，当虚拟机栈无法再容纳新的栈帧入栈时，会发生栈深度溢出异常，场景：")]),a._v(" "),t("ul",[t("li",[a._v("无限递归循环调用方法而无法退出")]),a._v(" "),t("li",[a._v("执行了大量方法，导致线程栈空间耗尽")]),a._v(" "),t("li",[a._v("方法内声明了海量的局部变量")])]),a._v(" "),t("p",[a._v("解决方案：")]),a._v(" "),t("ul",[t("li",[a._v("递归循环调用时注意退出逻辑")]),a._v(" "),t("li",[a._v("排查是否存在类间的循环依赖（当两个对象相互引用，在调用 toString() 时也会产生这个异常）")]),a._v(" "),t("li",[a._v("某些执行大量方法或包含大量局部变量的使用场景，可通过"),t("code",[a._v("-Xss")]),a._v("增加线程栈内存空间")])]),a._v(" "),t("h3",{attrs:{id:"outofmemoryerror"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#outofmemoryerror"}},[a._v("#")]),a._v(" OutOfMemoryError")]),a._v(" "),t("h4",{attrs:{id:"java-heap-space"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#java-heap-space"}},[a._v("#")]),a._v(" Java heap space")]),a._v(" "),t("p",[a._v("当 Java 堆没有足够内存空间分配新对象时，内存溢出异常，场景：")]),a._v(" "),t("ul",[t("li",[a._v("创建超大对象/超大数组时，新生代 Eden 区空间不够，且老年代空间也不够无法提供内存分配担保")]),a._v(" "),t("li",[a._v("超出预期的请求流量导致内存空间不够使用，可以结合业务流量指标排查是否有尖状峰值")]),a._v(" "),t("li",[a._v("过度使用"),t("code",[a._v("Finalizer")]),a._v("，该对象没有立即被 GC")]),a._v(" "),t("li",[a._v("内存泄漏（"),t("code",[a._v("Memory Leak")]),a._v("），大量对象引用没有被释放")])]),a._v(" "),t("blockquote",[t("p",[a._v("内存泄漏与内存溢出区别？")]),a._v(" "),t("ul",[t("li",[a._v("内存溢出("),t("code",[a._v("Out Of Memory")]),a._v(")：在申请内存时，无足够内存空间可使用，比如一个 Integer 空间存了 Long 类型的值，会发生内存溢出")]),a._v(" "),t("li",[a._v("内存泄露("),t("code",[a._v("Memory Leak")]),a._v(")：在申请内存后，无释放已申请的内存空间，一次内存泄露危害可以忽略，但内存泄露堆积后果很严重")])])]),a._v(" "),t("p",[a._v("解决方案：通常只需通过"),t("code",[a._v("-Xmx")]),a._v("参数调高 JVM 堆内存空间最大上限即可，也可考虑：")]),a._v(" "),t("ul",[t("li",[a._v("若是超大对象/超大数组，可以检查其合理性/有无必要")]),a._v(" "),t("li",[a._v("若是业务峰值流量压力，可以考虑添加机器资源，或限流降级")]),a._v(" "),t("li",[a._v("如果是内存泄漏，需要找到持有的对象，修改代码设计，比如关闭没有释放的连接")])]),a._v(" "),t("h4",{attrs:{id:"gc-overhead-limit-exceeded"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gc-overhead-limit-exceeded"}},[a._v("#")]),a._v(" GC overhead limit exceeded")]),a._v(" "),t("p",[a._v("当 Java 进程花费 98% 以上的时间执行 GC，但只恢复了不到 2% 的内存，且该动作连续重复了 5 次，就会抛出"),t("code",[a._v("GC overhead limit exceeded")]),a._v("。\n简单地说，就是应用程序已经基本耗尽了所有可用内存，GC 也无法回收，回收空间很快被使用，又会陷入 GC 恶性循环中")]),a._v(" "),t("h4",{attrs:{id:"permgen-space"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#permgen-space"}},[a._v("#")]),a._v(" Permgen space")]),a._v(" "),t("p",[a._v("表示永久代（"),t("code",[a._v("Permanent Generation")]),a._v("）已用满，通常是因为加载的 class 数目太多或体积太大，"),t("code",[a._v("PermGen")]),a._v("的使用量与加载到内存的 class 的数量/大小正相关")]),a._v(" "),t("p",[a._v("永久代主要存储对象包括：")]),a._v(" "),t("ul",[t("li",[a._v("加载/缓存到内存中的 class 定义")]),a._v(" "),t("li",[a._v("常量池")]),a._v(" "),t("li",[a._v("对象数组/类型数组所关联的 class")]),a._v(" "),t("li",[a._v("JIT 编译器优化后的 class 信息")])]),a._v(" "),t("p",[a._v("解决方案：")]),a._v(" "),t("ul",[t("li",[a._v("程序启动时报错，则可修改"),t("code",[a._v("-XX:MaxPermSize")]),a._v("，调大永久代空间")]),a._v(" "),t("li",[a._v("运行时报错，程序可能会动态创建大量短生命周期的 class，但 JVM 默认不卸载，可设置"),t("code",[a._v("-XX:+CMSClassUnloadingEnabled")]),a._v("及"),t("code",[a._v("-XX:+UseConcMarkSweepGC")]),a._v("允许 JVM 卸载")])]),a._v(" "),t("h4",{attrs:{id:"metaspace"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#metaspace"}},[a._v("#")]),a._v(" Metaspace")]),a._v(" "),t("p",[a._v("JDK 1.8 使用"),t("code",[a._v("Metaspace")]),a._v("替换了永久代（"),t("code",[a._v("Permanent Generation")]),a._v("），该错误表示"),t("code",[a._v("Metaspace")]),a._v("已被用满，通常是因为加载的 class 数目太多或体积太大，\n该问题与"),t("code",[a._v("Permgen space")]),a._v("类似，调整"),t("code",[a._v("Metaspace")]),a._v("空间大小的启动参数为"),t("code",[a._v("-XX:MaxMetaspaceSize")])]),a._v(" "),t("blockquote",[t("p",[a._v("永久代和元空间都是方法区（非堆）的实现方式")]),a._v(" "),t("p",[a._v("JDK1.8 之前使用永久代，JDK1.8 之后使用元空间")]),a._v(" "),t("p",[a._v("永久代使用的是 JVM 内存，而元空间并不在虚拟机内存中而是使用本地内存（直接内存）")])]),a._v(" "),t("blockquote",[t("p",[a._v("方法区溢出也是一种常见的内存溢出异常，在经常运行时生成大量动态类的应用场景中，应特别关注这些类的卸载回收情况")])]),a._v(" "),t("h4",{attrs:{id:"unable-to-create-new-native-thread"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#unable-to-create-new-native-thread"}},[a._v("#")]),a._v(" Unable to create new native thread")]),a._v(" "),t("p",[a._v("当 JVM 向底层操作系统（OS）请求创建"),t("code",[a._v("native")]),a._v("线程时，若没有足够的资源分配造成创建失败则报此类错误，常见场景：")]),a._v(" "),t("ul",[t("li",[a._v("线程数超过操作系统最大线程数 ulimit 限制")]),a._v(" "),t("li",[a._v("线程数超过 kernel.pid_max（只能重启）")]),a._v(" "),t("li",[a._v("native 内存不足：以下几步：\n"),t("ul",[t("li",[a._v("JVM 应用程序请求创建新 Java 线程")]),a._v(" "),t("li",[a._v("JVM native 方法代理该次请求，并向操作系统请求创建 native 线程")]),a._v(" "),t("li",[a._v("操作系统尝试创建一个新 native 线程，并为其分配内存")]),a._v(" "),t("li",[a._v("如果操作系统的虚拟内存已耗尽，或受到 32 位进程的地址空间限制，操作系统就会拒绝本次 native 内存分配")]),a._v(" "),t("li",[a._v("JVM 将抛出"),t("code",[a._v("Unable to create new native thread")]),a._v("异常")])])])]),a._v(" "),t("p",[a._v("解决方案：")]),a._v(" "),t("ul",[t("li",[a._v("修复线程泄漏问题，限制线程池大小")]),a._v(" "),t("li",[a._v("调高 OS 层面的线程最大数：执行"),t("code",[a._v("ulimit -a")]),a._v("查看最大线程数限制，使用"),t("code",[a._v("ulimit -u xxx")]),a._v("调整最大线程数限制")])]),a._v(" "),t("h4",{attrs:{id:"out-of-swap-space"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#out-of-swap-space"}},[a._v("#")]),a._v(" Out of swap space")]),a._v(" "),t("blockquote",[t("p",[a._v("虚拟内存（Virtual Memory）由物理内存（Physical Memory）和交换空间（Swap Space）两部分组成，在 JVM 请求的总内存大于可用物理内存时，操作系统开始将内容从内存换出到硬盘驱动器（使用交换空间）")])]),a._v(" "),t("p",[a._v("表示所有可用的虚拟内存已耗尽")]),a._v(" "),t("h4",{attrs:{id:"kill-process-or-sacrifice-child"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kill-process-or-sacrifice-child"}},[a._v("#")]),a._v(" Kill process or sacrifice child")]),a._v(" "),t("p",[a._v("有一种内核作业（Kernel Job）名为 Out of Memory Killer，它会在可用内存极低的情况下“杀死”（kill）某些进程。OOM Killer 会对所有进程进行打分，然后将评分较低的进程“杀死”")]),a._v(" "),t("p",[a._v("该错误不是由 JVM 层面触发的，而是由操作系统层面触发的。")]),a._v(" "),t("h4",{attrs:{id:"requested-array-size-exceeds-vm-limit"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#requested-array-size-exceeds-vm-limit"}},[a._v("#")]),a._v(" Requested array size exceeds VM limit")]),a._v(" "),t("p",[a._v("JVM 限制了数组的最大长度，该错误表示程序请求创建的数组超过最大长度限制")]),a._v(" "),t("h4",{attrs:{id:"direct-buffer-memory"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#direct-buffer-memory"}},[a._v("#")]),a._v(" Direct buffer memory")]),a._v(" "),t("blockquote",[t("p",[a._v("Java 允许应用程序通过"),t("code",[a._v("Direct ByteBuffer")]),a._v("直接访问堆外内存，许多高性能程序通过"),t("code",[a._v("Direct ByteBuffer")]),a._v("结合内存映射文件（"),t("code",[a._v("Memory Mapped File")]),a._v("）实现高速 IO")])]),a._v(" "),t("p",[t("code",[a._v("Direct ByteBuffer")]),a._v("的默认大小为 64 MB，一旦使用超出限制，就会抛出该错误，解决方案：")]),a._v(" "),t("ul",[t("li",[a._v("Java 只能通过"),t("code",[a._v("ByteBuffer.allocateDirect()")]),a._v("使用"),t("code",[a._v("Direct ByteBuffer")])]),a._v(" "),t("li",[a._v("通过启动参数"),t("code",[a._v("-XX:MaxDirectMemorySize")]),a._v("调整"),t("code",[a._v("Direct ByteBuffer")]),a._v("的上限值")]),a._v(" "),t("li",[a._v("检查 JVM 参数是否有"),t("code",[a._v("-XX:+DisableExplicitGC")]),a._v("选项，若有就去掉，因为该参数会使"),t("code",[a._v("System.gc()")]),a._v("失效")]),a._v(" "),t("li",[a._v("检查堆外内存是否存在内存泄漏，或反射调用"),t("code",[a._v("sun.misc.Cleaner.clean()")]),a._v("来主动释放被"),t("code",[a._v("Direct ByteBuffer")]),a._v("持有的内存空间")])]),a._v(" "),t("blockquote",[t("p",[t("code",[a._v("ByteBuffer.allocate(capability)")]),a._v("：分配 JVM 堆内存，属于 GC 范围，需内存拷贝所以速度相对较慢")]),a._v(" "),t("p",[t("code",[a._v("ByteBuffer.allocateDirect(capability)")]),a._v("：分配 OS 本地内存，不属于 GC 范围，无需内存拷贝所以速度相对较快")])]),a._v(" "),t("h2",{attrs:{id:"参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[a._v("#")]),a._v(" 参考")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1480668",target:"_blank",rel:"noopener noreferrer"}},[a._v("教你分析9种 OOM 常见原因及解决方案"),t("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=n.exports}}]);