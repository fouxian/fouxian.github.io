(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{474:function(s,a,t){"use strict";t.r(a);var n=t(34),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"hadoop-概述及分布式集群容器化部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hadoop-概述及分布式集群容器化部署"}},[s._v("#")]),s._v(" Hadoop 概述及分布式集群容器化部署")]),s._v(" "),t("p",[s._v("Hadoop 是由 Apache 软件基金会开发的分布式系统基础架构，一个用于海量数据的分布式存储与分布式计算的大数据生态圈，本文简述 Apache Hadoop 及 Cloudrea Hadoop（CDH）分布式集群的容器化部署")]),s._v(" "),t("h2",{attrs:{id:"大数据定义"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#大数据定义"}},[s._v("#")]),s._v(" 大数据定义")]),s._v(" "),t("p",[s._v("麦肯锡全球研究所：一种规模大到在获取、存储、管理、分析方面大大超出传统数据库软件工具能力范围的数据集合，具有海量的数据规模、快速的数据流转、多样的数据类型和价值密度低四大特征。")]),s._v(" "),t("p",[s._v("IBM 公司：大数据具有5V特点：Volume（大量）、Velocity（高速）、Variety（多样）、Value（价值）、Veracity（真实性）。")]),s._v(" "),t("h2",{attrs:{id:"hadoop-概述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hadoop-概述"}},[s._v("#")]),s._v(" Hadoop 概述")]),s._v(" "),t("p",[s._v("Hadoop 是由 Apache 软件基金会开发的分布式系统基础架构，一个用于海量数据的分布式存储与分布式计算的大数据生态圈，优点：")]),s._v(" "),t("ul",[t("li",[s._v("高可靠性：维护多个工作数据副本，确保能够针对失败的节点重新分布处理")]),s._v(" "),t("li",[s._v("高扩展性：集群可以方便地扩展到数以千计的节点中")]),s._v(" "),t("li",[s._v("高效性：在节点之间动态地移动数据，并保证各个节点的动态平衡，以并行的方式工作，通过并行处理加快处理速度")]),s._v(" "),t("li",[s._v("高容错性：自动保存数据的多个副本，并且能够自动将失败的任务重新分配")]),s._v(" "),t("li",[s._v("低成本：与一体机、商用数据仓库以及 QlikView、 Yonghong Z- Suites 等数据集市相比，Hadoop 是开源的，项目的软件成本因此会大大降低")])]),s._v(" "),t("p",[s._v("像 HBase、Hive 等不过是在以下基础模块上的高级抽象：")]),s._v(" "),t("ul",[t("li",[s._v("Common：支持其他模块的公用工具包，提供了操作文件系统、I/O、序列化和远程方法调用等")]),s._v(" "),t("li",[s._v("HDFS：是可扩展、容错、高性能、高吞吐的分布式文件系统，异步复制，一次写入多次读取，主要负责分布式存储")]),s._v(" "),t("li",[s._v("MapReduce：基于 YARN 的分布式计算框架，包含 Map(映射)和 Reduce(归约)过程，负责在 HDFS 上进行计算")]),s._v(" "),t("li",[s._v("YARN：负责集群资源的管理和任务调度")])]),s._v(" "),t("h2",{attrs:{id:"hadoop-1-x-2-x-3-x"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hadoop-1-x-2-x-3-x"}},[s._v("#")]),s._v(" Hadoop 1.x/2.x/3.x")]),s._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/bigdata/hadoop/Hadoop1.x-2.x.png",alt:"Hadoop1.x-2.x"}})]),s._v(" "),t("p",[t("big",[t("font",{attrs:{color:"#9f79ee"}},[t("em",[t("strong",[s._v("Hadoop 1.x")])])])],1)],1),s._v(" "),t("ul",[t("li",[s._v("HDFS：分布式文件系统")]),s._v(" "),t("li",[s._v("MapReduce：分布式计算引擎，资源管理平台\n"),t("ul",[t("li",[s._v("JobTracker：负责集群资源的管理、任务调度以及跟踪任务的状态；")]),s._v(" "),t("li",[s._v("TaskTracker：负责任务的执行与周期性地汇报本节点的资源使用情况和任务进度。")])])])]),s._v(" "),t("p",[t("big",[t("font",{attrs:{color:"#9f79ee"}},[t("em",[t("strong",[s._v("Hadoop 2.x")])])])],1)],1),s._v(" "),t("ul",[t("li",[s._v("HDFS：整体架构与 1.x 一致，新增特性：HA、Federation")]),s._v(" "),t("li",[s._v("MapReduce：从 1.x 中的 MapReduce 分离出的分布式计算引擎")]),s._v(" "),t("li",[s._v("YARN：从 1.x 中的 MapReduce 分离出的资源管理平台，支持更多计算引擎")])]),s._v(" "),t("p",[t("big",[t("font",{attrs:{color:"#9f79ee"}},[t("em",[t("strong",[s._v("Hadoop 3.x")])])])],1)],1),s._v(" "),t("p",[s._v("整体架构不变，提供了更高的性能、更强的容错能力以及更高效的数据处理能力，细节优化（新特性）：")]),s._v(" "),t("ul",[t("li",[s._v("Java 版本改为8以上")]),s._v(" "),t("li",[s._v("HDFS 支持纠删码")]),s._v(" "),t("li",[s._v("HDFS 支持多 NameNode")]),s._v(" "),t("li",[s._v("MapReduce 任务级本地优化")]),s._v(" "),t("li",[s._v("多重服务默认端口更改")]),s._v(" "),t("li",[s._v("用 Intra 解决 DataNode 宕机负载不均衡的问题")]),s._v(" "),t("li",[s._v("支持 Microsoft Azure Data Lake 文件系统")]),s._v(" "),t("li",[s._v("解决了 AMAZON S3 的数据一致性问题")])]),s._v(" "),t("h2",{attrs:{id:"cloudrea-hadoop-cdh"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cloudrea-hadoop-cdh"}},[s._v("#")]),s._v(" Cloudrea Hadoop（CDH）")]),s._v(" "),t("p",[t("big",[t("font",{attrs:{color:"#9f79ee"}},[t("em",[t("strong",[s._v("CDH")])])])],1),s._v(" 是 Cloudera 的一个拥有集群自动化安装、中心化管理、集群监控、报警功能的 Hadoop 发行版，完全开源，比 Apache Hadoop 在兼容性，安全性，稳定性上有所增强。支持 Yum 包、tar 包、RPM 包、Cloudera Manager 四种安装方式。")],1),s._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/bigdata/hadoop/CDH-%E6%9E%B6%E6%9E%84.jpg",alt:"CDH-架构"}}),s._v("\nCloudera Manager 功能：")]),s._v(" "),t("ul",[t("li",[s._v("管理：对集群进行管理，例如添加、删除节点等操作")]),s._v(" "),t("li",[s._v("监控：监控集群的健康情况，对设置的各种指标和系统的具体运行情况进行全面的监控")]),s._v(" "),t("li",[s._v("诊断：对集群出现的各种问题进行诊断，并且给出建议和解决方案")]),s._v(" "),t("li",[s._v("集成：多组件可以进行版本兼容间的整合")])]),s._v(" "),t("h2",{attrs:{id:"hadoop-生态圈"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hadoop-生态圈"}},[s._v("#")]),s._v(" Hadoop 生态圈")]),s._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/bigdata/hadoop/Hadoop%E7%94%9F%E6%80%81%E5%9C%88.jpg",alt:"Hadoop生态圈"}})]),s._v(" "),t("h1",{attrs:{id:"hadoop-分布式集群"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hadoop-分布式集群"}},[s._v("#")]),s._v(" Hadoop 分布式集群")]),s._v(" "),t("h2",{attrs:{id:"ssh-远程登录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ssh-远程登录"}},[s._v("#")]),s._v(" SSH 远程登录")]),s._v(" "),t("blockquote",[t("p",[s._v("SSH 相关知识点教程："),t("a",{attrs:{href:"https://gitee.com/mirrors_trending/ssh-tutorial/tree/main",target:"_blank",rel:"noopener noreferrer"}},[s._v("ssh-tutorial"),t("OutboundLink")],1)])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 登录格式")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -p：端口号、user：登录用户名、host：登录主机、默认端口号为22，当端口号为22时，可以省略")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" user@host\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 Linux 是否启用 SSH")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -ntlp "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"ssh-远程密码登录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ssh-远程密码登录"}},[s._v("#")]),s._v(" SSH 远程密码登录")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("xuzixian@LAPTOP-6NUV36V7 MINGW64 /g/Users/xzx-linux\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" xzx@192.168.120.159\nThe authenticity of "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.120.159 (192.168.120.159)'")]),s._v(" can"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'t be established.\nECDSA key fingerprint is SHA256:dgB46Zy110CFg99bnQErfKeU59ST5jzkcUrQLK4MGLQ.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".120.159"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("' (ECDSA) to the list of known hosts.\nxzx@192.168.120.159'")]),s._v("s password:\nLast login: Fri Jun "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" 06:43:56 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"ssh-远程免密登录-公钥登录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ssh-远程免密登录-公钥登录"}},[s._v("#")]),s._v(" SSH 远程免密登录（公钥登录）")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成本机密钥对，-t 表示加密算法选项，这里采用rsa加密算法")]),s._v("\nxuzixian@LAPTOP-6NUV36V7 MINGW64 /g/Users/xzx-linux\n$ ssh-keygen -t rsa\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 公钥复制到远程主机")]),s._v("\nxuzixian@LAPTOP-6NUV36V7 MINGW64 /g/Users/xzx-linux\n$ ssh-copy-id xzx@192.168.120.159\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 远程登录并查看公钥")]),s._v("\nxuzixian@LAPTOP-6NUV36V7 MINGW64 /g/Users/xzx-linux\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" xzx@192.168.120.159\nLast login: Sun Jun "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" 06:37:51 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v(" from "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".120.1\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ ll .ssh/authorized_keys\n-rw-------. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xzx xzx "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("578")]),s._v(" Jun "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":48 .ssh/authorized_keys\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h2",{attrs:{id:"hadoop-安装模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hadoop-安装模式"}},[s._v("#")]),s._v(" Hadoop 安装模式")]),s._v(" "),t("ul",[t("li",[s._v("单机模式：不能使用 HDFS，只能使用 MapReduce，所以单机模式主要用于测试 MR 程序")]),s._v(" "),t("li",[s._v("伪分布式模式：用多个线程模拟真实多台服务器，即模拟真实的完全分布式环境")]),s._v(" "),t("li",[s._v("完全分布式模式：用多台机器（或启动多个虚拟机）来完成部署集群")])]),s._v(" "),t("h2",{attrs:{id:"hadoop-集群节点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hadoop-集群节点"}},[s._v("#")]),s._v(" Hadoop 集群节点")]),s._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/bigdata/hadoop/Hadoop-%E9%9B%86%E7%BE%A4%E8%8A%82%E7%82%B9.bmp",alt:"Hadoop-集群节点"}})]),s._v(" "),t("ul",[t("li",[s._v("HDFS 服务的进程：NameNode、SecondaryNameNode、DataNode")]),s._v(" "),t("li",[s._v("YARN 服务的进程：ResourceManager、NodeManager")]),s._v(" "),t("li",[s._v("MapRedcue 计算框架没有进程，MapReduce 程序可以在上面进程上调度执行")])]),s._v(" "),t("h2",{attrs:{id:"分布式集群容器化部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#分布式集群容器化部署"}},[s._v("#")]),s._v(" 分布式集群容器化部署")]),s._v(" "),t("p",[s._v("准备 JDK 和 Hadoop 安装包：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上传本地 JDK 到 Linux 服务器")]),s._v("\nxuzixian@LAPTOP-6NUV36V7 MINGW64 /g/Users/fouxian\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" -r E:/downloads/BaiduNetdiskDownload/jdk-8u271-linux-x64.tar.gz xzx@192.168.120.159:/home/xzx/Work/hadoop-docker\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 网络下载 Hadoop 至 Linux 服务器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx hadoop-docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://mirrors.bfsu.edu.cn/apache/hadoop/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"镜像构建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#镜像构建"}},[s._v("#")]),s._v(" 镜像构建")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx ssh-centos7"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build -t "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xzx/ssh-centos7'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构建镜像 SSH ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx xzx-jdk"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build -t "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xzx/jdk1.8'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("                   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构建镜像 JDK")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx xzx-hadoop-cluster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build -t "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xzx/hadoop-3.2.2'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构建镜像 Hadoop")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx xzx-hadoop-cluster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\nREPOSITORY               TAG                 IMAGE ID            CREATED             SIZE\nxzx/hadoop-3.2.2         latest              8e069c860f5f        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" days ago          "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".61GB\nxzx/jdk-1.8              latest              dfa006cb7137        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" days ago          690MB\nxzx/ssh-centos7          latest              d3ae896e3ba1        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" days ago          334MB\ncentos                   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("                   8652b9f0cb4c        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" months ago        204MB\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"集群搭建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#集群搭建"}},[s._v("#")]),s._v(" 集群搭建")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx xzx-hadoop-cluster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ ll\ntotal "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("386212")]),s._v("\n-rwxrw-r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xzx xzx       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("243")]),s._v(" Jun "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(":20 build-image.sh             "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构建镜像脚本")]),s._v("\n-rwxrw-r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xzx xzx       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("380")]),s._v(" Jun "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(":04 clean-container.sh         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 清除容器脚本")]),s._v("\ndrwxrwxr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" xzx xzx       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("154")]),s._v(" Jun "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":38 config                     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Hadoop 配置文件")]),s._v("\n-rw-rw-r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xzx xzx      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1897")]),s._v(" Jun "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":40 Dockerfile                 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Hadoop Dockerfile")]),s._v("\n-rw-rw-r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xzx xzx "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("395448622")]),s._v(" Jan "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" 02:48 hadoop-3.2.2.tar.gz\n-rwxrw-r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xzx xzx       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("759")]),s._v(" Jun "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":51 resize-cluster.sh          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重置集群节点数")]),s._v("\n-rwxrw-r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xzx xzx      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1090")]),s._v(" Jun "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(":27 restart-container.sh       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启容器脚本")]),s._v("\ndrwxrwxr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" xzx xzx        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("54")]),s._v(" Jun "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(":05 script                     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Hadoop 启动脚本")]),s._v("\n-rwxrw-r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xzx xzx      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2213")]),s._v(" Jun "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":43 start-container.sh         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动容器脚本")]),s._v("\n-rwxrw-r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xzx xzx       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("370")]),s._v(" Jun "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(":02 stop-container.sh          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止容器脚本")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h4",{attrs:{id:"创建网桥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建网桥"}},[s._v("#")]),s._v(" 创建网桥")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用于 Hadoop 集群节点间的通信，通过网桥固定各容器 IP 地址")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx xzx-hadoop-cluster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network create --driver"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("bridge xzx-hadoop-bridge\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h4",{attrs:{id:"hadoop-配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hadoop-配置"}},[s._v("#")]),s._v(" Hadoop 配置")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" hadoop-env.sh\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JAVA_HOME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/jdk1.8.0_271\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HADOOP_LOG_DIR")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/data/hadoop/logs\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" core-site.xml\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("configuration"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("-- HDFS 默认访问路径，api 接口 --"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("fs.defaultFS"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("hdfs://xzx-hadoop-master:9000/"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("-- Hadoop 运行时产生的临时数据文件的存储位置 --"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("hadoop.tmp.dir"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("file:/usr/local/data/hadoop/tmp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("description"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("Abase "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" other temporary directories."),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/description"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/configuration"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" hdfs-site.xml\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("configuration"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("-- 设置 namende 数据存放点 --"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("dfs.namenode.name.dir"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("file:/usr/local/data/hadoop/namenode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("-- 设置 datanode 数据存放点 --"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("dfs.datanode.data.dir"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("file:/usr/local/data/hadoop/datanode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("-- 设置副本个数 --"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("dfs.replication"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("3")]),s._v("<")]),s._v("/value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/configuration"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" mapred-site.xml\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("configuration"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("-- 设置 mapreduce 的运行平台为 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" --"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("mapreduce.framework.name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("yarn"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/configuration"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" yarn-site.xml\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("configuration"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("-- reducer 获取数据的方式 --"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("yarn.nodemanager.aux-services"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("mapreduce_shuffle"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("-- 指定 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" 的老大的地址 --"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("yarn.resourcemanager.hostname"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("xzx-hadoop-master"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/value"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/property"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/configuration"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" workers\nxzx-hadoop-slave-1\nxzx-hadoop-slave-2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br")])]),t("h4",{attrs:{id:"容器启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#容器启动"}},[s._v("#")]),s._v(" 容器启动")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx xzx-hadoop-cluster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ ./start-container.sh  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认一主两从")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动的三个容器")]),s._v("\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                                                    NAMES\nd9e31c58d8dc        xzx/hadoop-3.2.2    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" minutes ago       Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" minutes        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32958-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp                                    xzx-hadoop-slave-2\n0f0bdc1f3070        xzx/hadoop-3.2.2    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" minutes ago       Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" minutes        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:32957-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp                                    xzx-hadoop-slave-1\naba464a6a09e        xzx/hadoop-3.2.2    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v("         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" minutes ago       Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" minutes        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:9868-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9868")]),s._v("/tcp, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:9870-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9870")]),s._v("/tcp   xzx-hadoop-master\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("访问 http://192.168.120.159:9870，http://192.168.120.159:8088")]),s._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/bigdata/hadoop/NameNode-UI.png",alt:"NameNode-UI"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"/images/kr/bigdata/hadoop/Yarn-UI.png",alt:"Yarn-UI"}})]),s._v(" "),t("blockquote",[t("p",[s._v("存在问题：resourcemanager 进程启动后又挂掉了，直接通过 docker exec 执行 start-yarn.sh 时，始终无法启动进程 resourcemanager，只有进行容器中才能启动成功")])]),s._v(" "),t("h4",{attrs:{id:"集群节点重置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#集群节点重置"}},[s._v("#")]),s._v(" 集群节点重置")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx xzx-hadoop-cluster"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ ./resize-cluster.sh N     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动容器指定 N - 1 个从节点")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"hadoop-客户端节点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hadoop-客户端节点"}},[s._v("#")]),s._v(" Hadoop 客户端节点")]),s._v(" "),t("div",{staticClass:"language-sh hadoop-client.sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为了集群安全，一般情况下，不直接通过集群中任意节点去操作整个集群，通过配置客户端节点操作集群")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只要在配置 slave 的时候，不要把客户端添加到 slave 里，")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 即客户端和 hadoop 集群其他的节点配置是一摸一样的，但不参与运算")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -a -q -f "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xzx-hadoop-client "),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),s._v(" /dev/null"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 没有找到 hadoop 客户端容器节点：xzx-hadoop-client，则创建客户端节点")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -itd --restart"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always --net"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xzx-hadoop-bridge --privileged "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n            -P "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n            --name xzx-hadoop-client "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n            --hostname xzx-hadoop-client "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n            xzx/hadoop-3.2.2 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n            /bin/bash\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("elif")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect --format "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{{.State.Running}}'")]),s._v(" xzx-hadoop-client"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# hadoop 客户端容器节点处于运行状态，无需重启")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" xzx-hadoop-client running "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启客户端节点")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start xzx-hadoop-client\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" xzx-hadoop-client started and running "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Hadoop 客户端连接集群验证")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx hadoop-docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it xzx-hadoop-client hdfs dfs -ls /\nFound "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" items\ndrwxr-xr-x   - root supergroup          "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-15 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":50 /jobTests\ndrwxr-xr-x   - root supergroup          "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-15 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":53 /out\ndrwxrwx---   - root supergroup          "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-15 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":52 /tmp\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx hadoop-docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it xzx-hadoop-client hadoop version\nHadoop "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.2")]),s._v(".2\nSource code repository Unknown -r 7a3bc90b05f257c8ace2f76d74264906f0f7a932\nCompiled by hexiaoqiao on "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-01-03T09:26Z\nCompiled with protoc "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.5")]),s._v(".0\nFrom "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" with checksum 5a8f564f46624254b27f6a33126ff4\nThis "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" was run using /usr/local/hadoop-3.2.2/share/hadoop/common/hadoop-common-3.2.2.jar\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("h1",{attrs:{id:"cdh"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cdh"}},[s._v("#")]),s._v(" CDH")]),s._v(" "),t("h1",{attrs:{id:"hdfs-ha"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hdfs-ha"}},[s._v("#")]),s._v(" HDFS HA")]),s._v(" "),t("h1",{attrs:{id:"代码仓库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#代码仓库"}},[s._v("#")]),s._v(" 代码仓库")]),s._v(" "),t("p",[s._v("代码仓库："),t("a",{attrs:{href:"https://gitee.com/fouxian/hadoop-docker",target:"_blank",rel:"noopener noreferrer"}},[s._v("hadoop-docker"),t("OutboundLink")],1)]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx hadoop-docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" config --global user.name "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xzx"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx hadoop-docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" config --global user.email xzx@163.com\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx hadoop-docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" init   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 初始化本地仓库")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 上传代码至本地仓库")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx hadoop-docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("  \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 忽略两个安装包")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx hadoop-docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" --cached xzx-jdk/jdk-8u271-linux-x64.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx hadoop-docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" --cached xzx-hadoop-cluster/hadoop-3.2.2.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx hadoop-docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit -m "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hadoop 分布式集群容器化部署"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提交代码至 Gitee 仓库")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx hadoop-docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" remote "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" origin https://gitee.com/xzx/hadoop-docker.git\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx hadoop-docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push -u origin master\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注：仓库中包含 JDK 和 Hadoop 安装包，由于上传文件限制，故通过（.gitignore）该忽略安装包文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx hadoop-docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" .gitignore\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx hadoop-docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" .gitignore\n*.tar.gz\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h1",{attrs:{id:"hdfs-shell"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hdfs-shell"}},[s._v("#")]),s._v(" HDFS Shell")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scheme：对于 HDFS 文件系统，scheme=hdfs；对于本地文件系统，scheme=file")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# authority：(ip:port)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scheme :// authority，指配置文件 core-site.xml 中的 fs.defaultFS 属性")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# path：具体文件路径")]),s._v("\nbin/hdfs dfs -cmd"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("args"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" scheme :// authority / path\nbin/hadoop fs -cmd"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("args"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" scheme :// authority / path\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[t("img",{attrs:{src:"/images/kr/bigdata/hadoop/HDFS-Shell.jpg",alt:"HDFS-Shell"}})]),s._v(" "),t("h1",{attrs:{id:"远程连接-docker-engine"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#远程连接-docker-engine"}},[s._v("#")]),s._v(" 远程连接 Docker Engine")]),s._v(" "),t("p",[s._v("Docker 默认只接受本地客户端的请求，远程连接 Docker Engine 有两种连接方式：")]),s._v(" "),t("ul",[t("li",[s._v("TCP：在服务端开始 TCP 连接，此连接为不安全连接，数据通过明文进行传输，缺省端口 2375")]),s._v(" "),t("li",[s._v("TCP_TLS：在 TCP 基础上加了 SSL 的安全证书，以保证连接安全，缺省端口 2376")])]),s._v(" "),t("h2",{attrs:{id:"tcp-无认证连接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tcp-无认证连接"}},[s._v("#")]),s._v(" TCP 无认证连接")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /usr/lib/systemd/system/docker.service             "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置远程客户端连接 Docker Engine")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在该行最后增加 -H tcp://0.0.0.0:2375，表示不限制访问地址，启动 TCP 连接")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/bin/dockerd -H fd:// --containerd"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/run/containerd/containerd.sock -H tcp://0.0.0.0:2375\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ systemctl daemon-reload                            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重载配置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ systemctl restart "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("                           "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启 docker 服务")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -tnpl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2375")]),s._v("                          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看监听端口")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ firewall-cmd --zone"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("public --add-port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2375")]),s._v("/tcp --permanent     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开放防火墙端口，permanent：表示持久")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ firewall-cmd --zone"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("public --remove-port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2375")]),s._v("/tcp --permanent     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭防火墙端口，permanent：表示持久")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ firewall-cmd --reload                              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启防火墙")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" -H tcp://192.168.120.159:2375 version       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 远程连接 Docker 并执行命令 version")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[t("img",{attrs:{src:"/images/kr/bigdata/hadoop/Docker-TCP.png",alt:"Docker-TCP"}})]),s._v(" "),t("h2",{attrs:{id:"tcp-tls-认证连接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tcp-tls-认证连接"}},[s._v("#")]),s._v(" TCP_TLS 认证连接")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx docker-tls"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ ./docker-tls.sh                        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成 CA 等证书文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx docker-tls"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ ll\ntotal "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("\n-r--------. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xzx xzx "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3326")]),s._v(" Jul "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":54 ca-key.pem          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CA 密钥")]),s._v("\n-r--r--r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xzx xzx "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1996")]),s._v(" Jul "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":54 ca.pem              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CA 证书")]),s._v("\n-r--r--r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xzx xzx "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1842")]),s._v(" Jul "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":54 client-cert.pem     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 客户端证书")]),s._v("\n-r--------. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xzx xzx "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3247")]),s._v(" Jul "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":54 client-key.pem      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 客户端密钥")]),s._v("\n-rwx------. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xzx xzx "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2097")]),s._v(" Jul "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":54 docker-tls.sh       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成脚本")]),s._v("\n-r--r--r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xzx xzx "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1854")]),s._v(" Jul "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":54 server-cert.pem     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务端证书")]),s._v("\n-r--------. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" xzx xzx "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3243")]),s._v(" Jul "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":54 server-key.pem      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务端密钥")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置 TCP_TLS")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("xzx@xzx ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /usr/lib/systemd/system/docker.service\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/bin/dockerd -H fd:// --containerd"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/run/containerd/containerd.sock "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n        --tlsverify "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n        --tlscacert"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/xzx/Work/hadoop-docker/docker-tls/ca.pem "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n        --tlscert"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/xzx/Work/hadoop-docker/docker-tls/server-cert.pem "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n        --tlskey"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/xzx/Work/hadoop-docker/docker-tls/server-key.pem "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n        -H tcp://0.0.0.0:2376\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 客户端配置，从服务端下载证书到客户端，需要重命名文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" xzx@192.168.120.159:/home/xzx/Work/hadoop-docker/docker-tls/ca.pem ./ca.pem\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" xzx@192.168.120.159:/home/xzx/Work/hadoop-docker/docker-tls/client-cert.pem ./cert.pem\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" xzx@192.168.120.159:/home/xzx/Work/hadoop-docker/docker-tls/client-key.pem ./key.pem\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("img",{attrs:{src:"/images/kr/bigdata/hadoop/Docker-TCP-TLS.png",alt:"Docker-TCP-TLS"}})]),s._v(" "),t("h1",{attrs:{id:"容器时间修改"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#容器时间修改"}},[s._v("#")]),s._v(" 容器时间修改")]),s._v(" "),t("p",[s._v("宿主机使用 CST(China Standard Time) 而 Docker 容器使用 UTC(Coordinated Universal Time)，那么两者就会相差 8 小时，修改容器时间方式：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TZ")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Asia/Shanghai  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 直接进入容器修改时区")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更新软链接")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@dmcdw-3 etc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# date")]),s._v("\nSun Sep "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":09:10 UTC "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@dmcdw-3 etc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /etc/localtime")]),s._v("\nlrwxrwxrwx. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" Nov "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(" /etc/localtime -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/usr/share/zoneinfo/UTC\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@dmcdw-3 etc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ln -snf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime        # 更新软连接")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@dmcdw-3 etc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll /etc/localtime")]),s._v("\nlrwxrwxrwx. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v(" Sep "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" 06:02 /etc/localtime -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/share/zoneinfo/Asia/Shanghai\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@dmcdw-3 etc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# date")]),s._v("\nMon Sep "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" 06:07:24 CST "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run 创建容器时挂载宿主机 localtime 文件到容器内")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -v /etc/localtime:/etc/localtime:ro\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);